(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[2741],{55026:function(Mt){Mt.exports={main:"main___31kpQ",headerList:"headerList___2mK7o",stepDescription:"stepDescription___15qRg",pageHeader:"pageHeader___3Ha2b",moreInfo:"moreInfo___2mXTE"}},8778:function(Mt,kt,l){"use strict";l.r(kt),l.d(kt,{default:function(){return ga}});var Wa=l(72012),vr=l(39144),Ba=l(66456),_e=l(85453),Ya=l(59250),pr=l(13013),Ka=l(30887),et=l(99210),Ja=l(22385),hr=l(69713),Xa=l(57663),me=l(71577),_a=l(62350),wt=l(75443),en=l(74379),ie=l(38648),J=l(3182),f=l(11849),tn=l(48736),ee=l(27049),rn=l(9715),Te=l(86585),yr=l(32059),S=l(2824),an=l(43358),tt=l(90290),gr=l(94043),T=l.n(gr),xr=l(1977),br=l(73218),Rt=l(92104),Et=l(47760),Ft=l(29934),Sr=l(1870),Zr=l(44545),Tr=l(20924),jr=l(65233),qr=l(64335),Cr=l(15103),Mr=l(21349),v=l(67294),ne=l(58086);function nn(){return rt.apply(this,arguments)}function rt(){return rt=_asyncToGenerator(_regeneratorRuntime.mark(function i(){return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",request("/api/profile/advanced"));case 1:case"end":return a.stop()}},i)})),rt.apply(this,arguments)}var Ce=l(91896);function ln(i,e){return at.apply(this,arguments)}function at(){return at=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,a){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/all",_objectSpread({method:"GET",params:_objectSpread({},s)},a||{})));case 2:case"end":return n.stop()}},i)})),at.apply(this,arguments)}function Pt(i,e){return nt.apply(this,arguments)}function nt(){return nt=(0,J.Z)(T().mark(function i(e,a){var s;return T().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=(0,Ce.Z)({},e),n.abrupt("return",(0,ne.WY)("/api/query/all",(0,f.Z)({method:"POST",params:(0,f.Z)({},s)},a||{})));case 2:case"end":return n.stop()}},i)})),nt.apply(this,arguments)}function sn(i,e){return lt.apply(this,arguments)}function lt(){return lt=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,a){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/deleteThenReturnAll",_objectSpread({method:"GET",params:_objectSpread({},s)},a||{})));case 2:case"end":return n.stop()}},i)})),lt.apply(this,arguments)}function kr(i,e){return it.apply(this,arguments)}function it(){return it=(0,J.Z)(T().mark(function i(e,a){var s;return T().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=(0,Ce.Z)({},e),n.abrupt("return",(0,ne.WY)("/api/query/deleteThenReturnAll",(0,f.Z)({method:"POST",params:(0,f.Z)({},s)},a||{})));case 2:case"end":return n.stop()}},i)})),it.apply(this,arguments)}function un(i,e){return st.apply(this,arguments)}function st(){return st=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,a){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/exportCsv",_objectSpread({method:"GET",params:_objectSpread({},s)},a||{})));case 2:case"end":return n.stop()}},i)})),st.apply(this,arguments)}function on(i,e){return ut.apply(this,arguments)}function ut(){return ut=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,a){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/exportCsv",_objectSpread({method:"POST",params:_objectSpread({},s)},a||{})));case 2:case"end":return n.stop()}},i)})),ut.apply(this,arguments)}function cn(i,e,a,s){return ot.apply(this,arguments)}function ot(){return ot=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,a,s,y){var n,F;return _regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return n=_extends({},e),F=new FormData,s&&F.append("Filedata",s[0]||""),Object.keys(a).forEach(function(Z){var b=a[Z];b!=null&&F.append(Z,typeof b=="object"?JSON.stringify(b):b)}),m.abrupt("return",request("/api/query/importCsv",_objectSpread({method:"POST",headers:{"Content-Type":"multipart/form-data"},params:_objectSpread({},n),data:F},y||{})));case 5:case"end":return m.stop()}},i)})),ot.apply(this,arguments)}function dn(i,e){return ct.apply(this,arguments)}function ct(){return ct=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,a){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/querySql",_objectSpread({method:"GET",params:_objectSpread({},s)},a||{})));case 2:case"end":return n.stop()}},i)})),ct.apply(this,arguments)}function wr(i,e){return dt.apply(this,arguments)}function dt(){return dt=(0,J.Z)(T().mark(function i(e,a){var s;return T().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=(0,Ce.Z)({},e),n.abrupt("return",(0,ne.WY)("/api/query/querySql",(0,f.Z)({method:"POST",params:(0,f.Z)({},s)},a||{})));case 2:case"end":return n.stop()}},i)})),dt.apply(this,arguments)}function fn(i,e){return ft.apply(this,arguments)}function ft(){return ft=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,a){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/querySqlAppend",_objectSpread({method:"GET",params:_objectSpread({},s)},a||{})));case 2:case"end":return n.stop()}},i)})),ft.apply(this,arguments)}function Rr(i,e){return mt.apply(this,arguments)}function mt(){return mt=(0,J.Z)(T().mark(function i(e,a){var s;return T().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=(0,Ce.Z)({},e),n.abrupt("return",(0,ne.WY)("/api/query/querySqlAppend",(0,f.Z)({method:"POST",params:(0,f.Z)({},s)},a||{})));case 2:case"end":return n.stop()}},i)})),mt.apply(this,arguments)}function mn(i,e){return vt.apply(this,arguments)}function vt(){return vt=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,a){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/save",_objectSpread({method:"GET",params:_objectSpread({},s)},a||{})));case 2:case"end":return n.stop()}},i)})),vt.apply(this,arguments)}function Er(i,e){return pt.apply(this,arguments)}function pt(){return pt=(0,J.Z)(T().mark(function i(e,a){var s;return T().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=(0,Ce.Z)({},e),n.abrupt("return",(0,ne.WY)("/api/query/save",(0,f.Z)({method:"POST",params:(0,f.Z)({},s)},a||{})));case 2:case"end":return n.stop()}},i)})),pt.apply(this,arguments)}function vn(i,e){return ht.apply(this,arguments)}function ht(){return ht=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,a){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/updatePoint",_objectSpread({method:"GET",params:_objectSpread({},s)},a||{})));case 2:case"end":return n.stop()}},i)})),ht.apply(this,arguments)}function Fr(i,e){return yt.apply(this,arguments)}function yt(){return yt=(0,J.Z)(T().mark(function i(e,a){var s;return T().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=(0,Ce.Z)({},e),n.abrupt("return",(0,ne.WY)("/api/query/updatePoint",(0,f.Z)({method:"POST",params:(0,f.Z)({},s)},a||{})));case 2:case"end":return n.stop()}},i)})),yt.apply(this,arguments)}var Pr=l(55026),je=l.n(Pr);function Or(i,e,a){a!=null&&(i==null||i.code!="0")?a.error({message:i.message}):e(i)}function Hr(i,e){var a=URL.createObjectURL(new Blob([i])),s=document.createElement("a");s.style.display="none",s.href=a,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s)}function Ir(i){var e=document.createElement("a");e.style.display="none",e.href=i,document.body.appendChild(e),e.click(),document.body.removeChild(e)}var Oe={dealCallback:Or,download:Hr,download2:Ir},Me=l(86582),pn=l(49111),$r=l(19650),hn=l(47673),ye=l(4107),Ve=l(37476),Ar=l(59879),Ot=l(43061),Nr=l(30381),Ht=l.n(Nr),t=l(85893),Lr=ye.Z.Search,yn=ye.Z.TextArea,Qr=function(e){var a=(0,ne.YB)(),s=e.done,y=e.visible,n=e.content,F=e.setContent,w=e.querySql,m=e.activeQueryTabkey,Z=e.setQuerySql,b=e.setVisible,r=(0,ne.tT)("@@initialState"),M=r.initialState,E=r.setInitialState,Y=(0,v.useState)(void 0),R=(0,S.Z)(Y,2),k=R[0],$=R[1],D=tt.Z.Option,H=Te.Z.useForm(),U=(0,S.Z)(H,1),G=U[0],ae=(0,ne.QT)((0,J.Z)(T().mark(function d(){return T().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:case"end":return h.stop()}},d)}))),K=ae.data,le=ae.loading,N=ae.mutate,o=function(){var d=(0,J.Z)(T().mark(function u(h,x,I){var P;return T().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,Pt({pageSize:10,pageNum:h,nameLike:I});case 2:P=Q.sent,Oe.dealCallback(P,function(A){var X=0;A.data.pageItems.map(function(W){W.key=X++}),F(A.data)},ie.default);case 4:case"end":return Q.stop()}},u)}));return function(h,x,I){return d.apply(this,arguments)}}(),g=function(){var d=(0,J.Z)(T().mark(function u(h){var x;return T().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,kr({queryId:h.id,pageSize:10,pageNum:1,nameLike:k});case 2:x=P.sent,Oe.dealCallback(x,function(L){var Q=0;L.data.pageItems.map(function(A){A.key=Q++}),F(L.data)},ie.default);case 4:case"end":return P.stop()}},u)}));return function(h){return d.apply(this,arguments)}}(),c=[{title:a.formatMessage({id:"query.sql.script.name"}),dataIndex:"name",key:"name",width:"20%",render:function(u){return(0,t.jsx)("div",{children:u})}},{title:"SQL",dataIndex:"sqls",key:"sqls",width:"45%",render:function(u){return(0,t.jsx)("div",{children:u})}},{title:a.formatMessage({id:"query.sql.script.createTime"}),dataIndex:"createTime",key:"createTime",width:"20%",render:function(u){return(0,t.jsx)(t.Fragment,{children:Ht()(parseInt(u)).format("YYYY-MM-DD HH:mm")})}},{title:a.formatMessage({id:"pages.operation.text"}),key:"action",render:function(u,h){return(0,t.jsxs)($r.Z,{size:"middle",children:[(0,t.jsx)("a",{onClick:function(I){w[m]=h.sqls,Z((0,f.Z)({},w)),b(!1)},children:a.formatMessage({id:"pages.use.text"})}),(0,t.jsx)(wt.Z,{placement:"left",title:h.name+" -- "+a.formatMessage({id:"pages.delete.confirm"}),onConfirm:function(I){return g(h,I)},children:(0,t.jsx)("a",{children:a.formatMessage({id:"pages.delete.text"})})})]})}}];return y?(0,t.jsx)(Ve.Z,{visible:y,form:G,title:a.formatMessage({id:"query.sql.script.view"}),className:je().standardListForm,initialValues:n.pageItems,submitter:{submitButtonProps:{style:{display:"none"}},render:function(u,h){return(0,Me.Z)(h)}},modalProps:{onCancel:function(){return b(!1)},destroyOnClose:!0,bodyStyle:s?{padding:"72px 0"}:{}},children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{textAlign:"right",marginBottom:"10px",marginTop:"-10px"},children:(0,t.jsxs)(me.Z.Group,{children:[(0,t.jsxs)(me.Z,{value:"all",onClick:function(){$(null),o(1,10)},children:[(0,t.jsx)(Ar.Z,{}),a.formatMessage({id:"pages.refresh.text"})]}),(0,t.jsx)(Lr,{style:{width:"190px"},placeholder:a.formatMessage({id:"pages.refresh.placeholder"}),onSearch:function(u){o(1,10,u)},onChange:function(u){$(u.target.value)},value:k,suffix:k==null||k==""?(0,t.jsx)(Ot.Z,{style:{display:"none"}}):(0,t.jsx)(Ot.Z,{style:{color:"rgba(0,0,0,.45)"},onClick:function(){$(null)}})})]})}),(0,t.jsx)(_e.Z,{columns:c,dataSource:n.pageItems,pagination:{showSizeChanger:!1,showQuickJumper:!0,pageSize:10,current:n==null?1:n.pageNo,total:n==null?1:n.totalCount,onChange:function(u,h){o(u,h,k)}}})]})}):null},zr=Qr,It=l(5966),gn=ye.Z.Search,xn=ye.Z.TextArea,Gr=function(e){var a=(0,ne.YB)(),s=e.done,y=e.visible,n=e.setVisible,F=e.querySql,w=e.activeQueryTabkey,m=Te.Z.useForm(),Z=(0,S.Z)(m,1),b=Z[0],r=(0,ne.QT)((0,J.Z)(T().mark(function k(){return T().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:case"end":return D.stop()}},k)}))),M=r.data,E=r.loading,Y=r.mutate,R=function(){var k=(0,J.Z)(T().mark(function $(D){var H;return T().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,Er({sqls:F[w],name:D});case 2:H=G.sent,Oe.dealCallback(H,function(ae){ie.default.success({message:a.formatMessage({id:"query.sql.script.save.success"})+" "+D}),n(!1)},ie.default);case 4:case"end":return G.stop()}},$)}));return function(D){return k.apply(this,arguments)}}();return y?(0,t.jsx)(Ve.Z,{visible:y,form:b,title:a.formatMessage({id:"query.sql.script.create"}),className:je().standardListForm,submitter:{render:function($,D){return(0,Me.Z)(D)}},onFinish:function($){R($.name)},modalProps:{onCancel:function(){return n(!1)},destroyOnClose:!0,bodyStyle:s?{padding:"72px 0"}:{}},children:(0,t.jsx)(It.Z,{name:"name",label:a.formatMessage({id:"query.sql.script.name"}),rules:[{required:!0}]})}):null},Vr=Gr,bn=l(13062),gt=l(71230),Sn=l(89032),ke=l(15746),xt=l(86615),$t=l(64317),At=l(29656),Ur=l(4631),Dr=l.n(Ur);(function(i){typeof exports=="object"?i(l(4631)):typeof define=="function"&&l.amdO?define(["../../../node_modules/codemirror/lib/codemirror"],i):i(Dr())})(function(i){"use strict";i.defineMode("iotdb-sql",function(m,Z){var b=Z.client||{},r=Z.atoms||{false:!0,true:!0,null:!0},M=Z.builtin||F(w),E=Z.keywords||F(n),Y=Z.operatorChars||/^[*+\-%<>!=&|~^\/]/,R=Z.support||{},k=Z.hooks||{},$=Z.dateSQL||{date:!0,time:!0,timestamp:!0},D=Z.backslashStringEscapes!==!1,H=Z.brackets||/^[\{}\(\)\[\]]/,U=Z.punctuation||/^[;.,:]/;function G(o,g){var c=o.next();if(k[c]){var d=k[c](o,g);if(d!==!1)return d}if(R.hexNumber&&(c=="0"&&o.match(/^[xX][0-9a-fA-F]+/)||(c=="x"||c=="X")&&o.match(/^'[0-9a-fA-F]+'/)))return"number";if(R.binaryNumber&&((c=="b"||c=="B")&&o.match(/^'[01]+'/)||c=="0"&&o.match(/^b[01]+/)))return"number";if(c.charCodeAt(0)>47&&c.charCodeAt(0)<58)return o.match(/^[0-9]*(\.[0-9]+)?([eE][-+]?[0-9]+)?/),R.decimallessFloat&&o.match(/^\.(?!\.)/),"number";if(c=="?"&&(o.eatSpace()||o.eol()||o.eat(";")))return"variable-3";if(c=="'"||c=='"'&&R.doubleQuote)return g.tokenize=ae(c),g.tokenize(o,g);if((R.nCharCast&&(c=="n"||c=="N")||R.charsetCast&&c=="_"&&o.match(/[a-z][a-z0-9]*/i))&&(o.peek()=="'"||o.peek()=='"'))return"keyword";if(R.escapeConstant&&(c=="e"||c=="E")&&(o.peek()=="'"||o.peek()=='"'&&R.doubleQuote))return g.tokenize=function(h,x){return(x.tokenize=ae(h.next(),!0))(h,x)},"keyword";if(R.commentSlashSlash&&c=="/"&&o.eat("/"))return o.skipToEnd(),"comment";if(R.commentHash&&c=="#"||c=="-"&&o.eat("-")&&(!R.commentSpaceRequired||o.eat(" ")))return o.skipToEnd(),"comment";if(c=="/"&&o.eat("*"))return g.tokenize=K(1),g.tokenize(o,g);if(c=="."){if(R.zerolessFloat&&o.match(/^(?:\d+(?:e[+-]?\d+)?)/i))return"number";if(o.match(/^\.+/))return null;if(R.ODBCdotTable&&o.match(/^[\w\d_$#]+/))return"variable-2"}else{if(Y.test(c))return o.eatWhile(Y),"operator";if(H.test(c))return"bracket";if(U.test(c))return o.eatWhile(U),"punctuation";if(c=="{"&&(o.match(/^( )*(d|D|t|T|ts|TS)( )*'[^']*'( )*}/)||o.match(/^( )*(d|D|t|T|ts|TS)( )*"[^"]*"( )*}/)))return"number";o.eatWhile(/^[_\w\d]/);var u=o.current().toLowerCase();return $.hasOwnProperty(u)&&(o.match(/^( )+'[^']*'/)||o.match(/^( )+"[^"]*"/))?"number":r.hasOwnProperty(u)?"atom":M.hasOwnProperty(u)?"builtin":E.hasOwnProperty(u)?"keyword":b.hasOwnProperty(u)?"string-2":null}}function ae(o,g){return function(c,d){for(var u=!1,h;(h=c.next())!=null;){if(h==o&&!u){d.tokenize=G;break}u=(D||g)&&!u&&h=="\\"}return"string"}}function K(o){return function(g,c){var d=g.match(/^.*?(\/\*|\*\/)/);return d?d[1]=="/*"?c.tokenize=K(o+1):o>1?c.tokenize=K(o-1):c.tokenize=G:g.skipToEnd(),"comment"}}function le(o,g,c){g.context={prev:g.context,indent:o.indentation(),col:o.column(),type:c}}function N(o){o.indent=o.context.indent,o.context=o.context.prev}return{startState:function(){return{tokenize:G,context:null}},token:function(g,c){if(g.sol()&&c.context&&c.context.align==null&&(c.context.align=!1),c.tokenize==G&&g.eatSpace())return null;var d=c.tokenize(g,c);if(d=="comment")return d;c.context&&c.context.align==null&&(c.context.align=!0);var u=g.current();return u=="("?le(g,c,")"):u=="["?le(g,c,"]"):c.context&&c.context.type==u&&N(c),d},indent:function(g,c){var d=g.context;if(!d)return i.Pass;var u=c.charAt(0)==d.type;return d.align?d.col+(u?0:1):d.indent+(u?0:m.indentUnit)},blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:R.commentSlashSlash?"//":R.commentHash?"#":"--",closeBrackets:"()[]{}''\"\"``"}});function e(m){for(var Z;(Z=m.next())!=null;)if(Z=="`"&&!m.eat("`"))return"variable-2";return m.backUp(m.current().length-1),m.eatWhile(/\w/)?"variable-2":null}function a(m){for(var Z;(Z=m.next())!=null;)if(Z=='"'&&!m.eat('"'))return"variable-2";return m.backUp(m.current().length-1),m.eatWhile(/\w/)?"variable-2":null}function s(m){return m.eat("@")&&(m.match("session."),m.match("local."),m.match("global.")),m.eat("'")?(m.match(/^.*'/),"variable-2"):m.eat('"')?(m.match(/^.*"/),"variable-2"):m.eat("`")?(m.match(/^.*`/),"variable-2"):m.match(/^[0-9a-zA-Z$\.\_]+/)?"variable-2":null}function y(m){return m.eat("N")?"atom":m.match(/^[a-zA-Z.#!?]/)?"variable-2":null}var n="alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit ";function F(m){for(var Z={},b=m.split(" "),r=0;r<b.length;++r)Z[b[r]]=!0;return Z}var w="bool boolean bit blob enum long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision real date datetime year unsigned signed decimal numeric";i.defineMIME("text/iotdb-sql",{name:"sql",keywords:F("non_negative_derivative derivative non_negative_difference difference time_difference bottom_k top_k string_matches string_contains abs sqrt log10 ln exp round floor ceil sign radians degrees atan acos asin tan cos sin int32 int64 float double boolean text false true null time timestamp lock any without debug explain tolerance like concat contain top asc desc stop start after before triggers trigger as functions function temporary schema for snapshot partition latest cache clear full global rename tags attributes compression align disable last last_value sum first_value avg max_value min_value max_time min_time level nodes count devices paths child move remove version info task flush ttl unset watermark_embedding load revoke password alter of all role privileges user list merge drop off on tracing using index link now values alias upsert add bitmap encoding insert create update delete select show query kill processlist grant into set where from to order by device configuration describe slimit limit unlink offset soffset fill linear previous previousuntillast metadata timeseries property with datatype compressor storage group label"),builtin:F("root now non_negative_derivative derivative non_negative_difference difference time_difference bottom_k top_k string_matches string_contains max_time min_time max_value min_value last_value first_value sum avg count abs sqrt log10 ln exp round floor ceil sign radians degrees atan acos asin tan cos sin false true null time timestamp int32 int64 float double boolean text"),atoms:F("plain plain_dictionary rle diff ts_2diff gorilla regular pla paa lzo gzip lz4 snappy uncompressed"),dateSQL:F(""),support:F("commentHash ODBCdotTable doubleQuote binaryNumber hexNumber")})});var Zn=l(71707),Tn=l(3585),jn=l(14504),qn=ye.Z.Search,Cn=ye.Z.TextArea,Wr=function(e){var a=(0,ne.YB)(),s=e.done,y=e.visible,n=e.setVisible,F=e.exportCsv,w=e.activeQueryTabkey,m=(0,ne.tT)("@@initialState"),Z=m.initialState,b=m.setInitialState,r=v.useState(void 0),M=(0,S.Z)(r,2),E=M[0],Y=M[1],R=(0,v.useState)({query1:"select * from root"}),k=(0,S.Z)(R,1),$=k[0],D=v.useState("number"),H=(0,S.Z)(D,2),U=H[0],G=H[1],ae=v.useState("+08:00"),K=(0,S.Z)(ae,2),le=K[0],N=K[1],o=v.useState(!0),g=(0,S.Z)(o,2),c=g[0],d=g[1],u=v.useState("plain"),h=(0,S.Z)(u,2),x=h[0],I=h[1],P=Te.Z.useForm(),L=(0,S.Z)(P,1),Q=L[0],A=(0,t.jsx)(At.Rt,{value:$.query1,options:{mode:"text/iotdb-sql",theme:"juejin",autofocus:!1,lineNumbers:!0,tabindex:1,extraKeys:{"Alt-/":"autocomplete","Ctrl-/":"toggleComment"},matchBrackets:!0,indentWithTabs:!0,smartIndent:!0,hintOptions:{completeSingle:!1}},onChange:function(W,te,ce){te.origin!=null&&(te.removed[0].trim()!=""||te.text[0].match(/^[a-zA-Z0-9_]+$/))&&W.showHint(),$.query1=ce}});return y?(0,t.jsxs)(Ve.Z,{visible:y,form:Q,title:a.formatMessage({id:"query.sql.export"}),className:je().standardListForm,column:2,submitter:{submitButtonProps:{style:{display:"none"}},render:function(W,te){return[].concat((0,Me.Z)(te),[(0,t.jsx)(me.Z,{type:"primary",onClick:function(){F({queryCommand:$.query1,targetFile:E,timeformat:U,timeZone:le,compress:x})},children:a.formatMessage({id:"query.sql.export"})},"export")])}},modalProps:{onCancel:function(){return n(!1)},destroyOnClose:!0,bodyStyle:s?{padding:"72px 0"}:{}},children:[(0,t.jsx)("div",{style:{marginBottom:10},children:a.formatMessage({id:"query.sql.export.sqlWithRequired"})}),(0,t.jsx)("div",{style:{marginBottom:20},children:A}),(0,t.jsxs)(gt.Z,{gutter:16,children:[(0,t.jsx)(ke.Z,{lg:12,md:24,sm:48,children:(0,t.jsx)(It.Z,{name:"name",label:a.formatMessage({id:"query.sql.export.backupNameWithOptional"}),placeholder:"dump",fieldProps:{value:E,onChange:function(W){Y(W.target.value)}}})}),(0,t.jsx)(ke.Z,{lg:10,md:20,sm:40,children:(0,t.jsx)(xt.Z.Group,{name:"compress",label:a.formatMessage({id:"query.sql.export.compressionMode"}),radioType:"button",size:"small",options:[{label:a.formatMessage({id:"query.sql.export.compression.no"}),value:"plain"},{label:"GZIP",value:"gzip"},{label:"SNAPPY",value:"snappy"}],initialValue:x,fieldProps:{buttonStyle:"solid",onChange:function(W){I(W.target.value)}}})})]}),(0,t.jsxs)(gt.Z,{gutter:16,children:[(0,t.jsx)(ke.Z,{lg:12,md:24,sm:48,children:(0,t.jsx)(xt.Z.Group,{name:"tf",label:a.formatMessage({id:"query.sql.export.timeFormat"}),radioType:"button",size:"small",options:[{label:a.formatMessage({id:"query.sql.export.timeFormat.number"}),value:"number"},{label:a.formatMessage({id:"query.sql.export.timeFormat.default"}),value:"default"},{label:a.formatMessage({id:"query.sql.export.timeFormat.timestamp"}),value:"yyyy-MM-dd HH:mm:ss.SSS"}],initialValue:U,fieldProps:{buttonStyle:"solid",onChange:function(W){W.target.value=="number"?d(!0):d(!1),G(W.target.value)}}})}),(0,t.jsx)(ke.Z,{lg:10,md:20,sm:40,children:(0,t.jsx)($t.Z,{label:a.formatMessage({id:"query.sql.export.timeZone"}),name:"zone",disabled:c,options:[{label:"-12:00",value:"-12:00"},{label:"-11:00",value:"-11:00"},{label:"-10:00",value:"-10:00"},{label:"-09:00",value:"-09:00"},{label:"-08:00",value:"-08:00"},{label:"-07:00",value:"-07:00"},{label:"-06:00",value:"-06:00"},{label:"-05:00",value:"-05:00"},{label:"-04:00",value:"-04:00"},{label:"-03:00",value:"-03:00"},{label:"-02:00",value:"-02:00"},{label:"-01:00",value:"-01:00"},{label:"+00:00",value:"+00:00"},{label:"+01:00",value:"+01:00"},{label:"+02:00",value:"+02:00"},{label:"+03:00",value:"+03:00"},{label:"+04:00",value:"+04:00"},{label:"+05:00",value:"+05:00"},{label:"+06:00",value:"+06:00"},{label:"+07:00",value:"+07:00"},{label:"+08:00",value:"+08:00"},{label:"+09:00",value:"+09:00"},{label:"+10:00",value:"+10:00"},{label:"+11:00",value:"+11:00"},{label:"+12:00",value:"+12:00"}],initialValue:"+08:00",fieldProps:{allowClear:!1,onChange:function(W){N(W)}}})})]})]}):null},Br=Wr,Mn=l(43185),Yr=l(11324),kn=ye.Z.Search,wn=ye.Z.TextArea,Kr=function(e){var a=(0,ne.YB)(),s=e.done,y=e.visible,n=e.setVisible,F=e.activeQueryTabkey,w=v.useState(void 0),m=(0,S.Z)(w,2),Z=m[0],b=m[1],r=v.useState("+08:00"),M=(0,S.Z)(r,2),E=M[0],Y=M[1],R=v.useState("plain"),k=(0,S.Z)(R,2),$=k[0],D=k[1],H=v.useState(0),U=(0,S.Z)(H,2),G=U[0],ae=U[1],K=v.useState(!1),le=(0,S.Z)(K,2),N=le[0],o=le[1],g=Te.Z.useForm(),c=(0,S.Z)(g,1),d=c[0];return y?(0,t.jsx)(Ve.Z,{visible:y,form:d,title:a.formatMessage({id:"query.sql.import"}),className:je().standardListForm,column:2,submitter:{submitButtonProps:{style:{display:"none"}},render:function(h,x){return[].concat((0,Me.Z)(x),[(0,t.jsx)(Yr.Z,{action:"/api/query/importCsv",name:"Filedata",showUploadList:!1,data:{compress:$,timeZone:E},beforeUpload:function(P){var L=P.name,Q=L.substring(L.lastIndexOf(".")),A=P.size,X=3,W=Math.ceil(A/1024/1024),te=Math.ceil(W*10);return $=="plain"&&Q!=".csv"?(ie.default.error({message:a.formatMessage({id:"query.sql.import.compression.no.rule"})}),!1):$=="snappy"&&Q!=".snappy"?(ie.default.error({message:a.formatMessage({id:"query.sql.import.compression.snappy.rule"})}),!1):$=="gzip"&&Q!=".gz"?(ie.default.error({message:a.formatMessage({id:"query.sql.import.compression.gzip.rule"})}),!1):W>X?(ie.default.error({message:a.formatMessage({id:"query.sql.import.size.rule"})+" "+X+" MB"}),!1):!0},onChange:function(P){P.file.response!=null&&(o(!1),(P.file.response.code!="0"||P.file.status=="error")&&ie.default.error({message:P.file.response.message}))},withCredentials:!0,children:(0,t.jsx)(me.Z,{type:"primary",children:a.formatMessage({id:"query.sql.import.selectFile"})},"import")},"upload")])}},modalProps:{onCancel:function(){n(!1)},destroyOnClose:!0,bodyStyle:s?{padding:"72px 0"}:{}},children:(0,t.jsxs)(gt.Z,{gutter:16,children:[(0,t.jsx)(ke.Z,{lg:12,md:24,sm:48,children:(0,t.jsx)(xt.Z.Group,{name:"compress",label:a.formatMessage({id:"query.sql.export.compressionMode"}),radioType:"button",size:"small",options:[{label:a.formatMessage({id:"query.sql.export.compression.no"}),value:"plain"},{label:"GZIP",value:"gzip"},{label:"SNAPPY",value:"snappy"}],initialValue:$,fieldProps:{buttonStyle:"solid",onChange:function(h){D(h.target.value)}}})}),(0,t.jsx)(ke.Z,{lg:10,md:20,sm:40,children:(0,t.jsx)($t.Z,{label:a.formatMessage({id:"query.sql.export.timeZone"}),tooltip:a.formatMessage({id:"query.sql.export.timeZone.description"}),name:"zone",options:[{label:"-12:00",value:"-12:00"},{label:"-11:00",value:"-11:00"},{label:"-10:00",value:"-10:00"},{label:"-09:00",value:"-09:00"},{label:"-08:00",value:"-08:00"},{label:"-07:00",value:"-07:00"},{label:"-06:00",value:"-06:00"},{label:"-05:00",value:"-05:00"},{label:"-04:00",value:"-04:00"},{label:"-03:00",value:"-03:00"},{label:"-02:00",value:"-02:00"},{label:"-01:00",value:"-01:00"},{label:"+00:00",value:"+00:00"},{label:"+01:00",value:"+01:00"},{label:"+02:00",value:"+02:00"},{label:"+03:00",value:"+03:00"},{label:"+04:00",value:"+04:00"},{label:"+05:00",value:"+05:00"},{label:"+06:00",value:"+06:00"},{label:"+07:00",value:"+07:00"},{label:"+08:00",value:"+08:00"},{label:"+09:00",value:"+09:00"},{label:"+10:00",value:"+10:00"},{label:"+11:00",value:"+11:00"},{label:"+12:00",value:"+12:00"}],initialValue:"+08:00",fieldProps:{value:E,allowClear:!1,onChange:function(h){Y(h)}}})})]})}):null},Jr=Kr,Xr=l(44008),bt=l(55877),Rn=l(402),Nt=l(59289),En=l(77883),St=l(51368),Ue=l(93224),_r=l(54549),ea=l(79508),ta=l(2603),ra=l(81296),aa=l(58848),be;(function(i){i.INITHEIGHT="INITHEIGHT",i.RENDERTR="RENDERTR",i.RESET="RESET"})(be||(be={}));var Lt={rowHeight:0,curScrollTop:0,scrollHeight:0,tableScrollY:0};function na(i,e){var a=e.curScrollTop,s=e.scrollHeight,y=e.tableScrollY,n=e.rowHeight;switch(e.type){case be.RENDERTR:return s<0&&(s=0),i.scrollHeight&&y===i.tableScrollY&&(s=i.scrollHeight),i.scrollHeight&&a>i.scrollHeight&&(a=i.scrollHeight),(0,f.Z)((0,f.Z)({},i),{},{curScrollTop:a,scrollHeight:s,tableScrollY:y});case be.INITHEIGHT:return(0,f.Z)((0,f.Z)({},i),{},{rowHeight:n});case be.RESET:return(0,f.Z)((0,f.Z)({},i),{},{curScrollTop:0,scrollHeight:0});default:throw new Error}}var Zt=(0,v.createContext)({dispatch:Function,renderLen:1,start:0,offsetStart:0,rowHeight:Lt.rowHeight,totalLen:0}),Tt=0,He=null,Fn=function(e){var a=e.children,s=_objectWithoutProperties(e,["children"]);return _jsx("td",_objectSpread(_objectSpread({},s),{},{children:_jsx("div",{children:"zxc"})}))},la=function(e){var a=(0,v.useContext)(Zt),s=a.dispatch,y=a.rowHeight,n=a.totalLen,F=e.children,w=(0,Ue.Z)(e,["children"]),m=(0,v.useRef)(null);return(0,v.useEffect)(function(){var Z=function(r){var M;if(r!=null&&(M=r.current)!==null&&M!==void 0&&M.offsetHeight&&!y&&n){var E,Y,R=(E=r==null||(Y=r.current)===null||Y===void 0?void 0:Y.offsetHeight)!==null&&E!==void 0?E:0;s({type:be.INITHEIGHT,rowHeight:R})}};Z(m)},[m,y,n,s]),(0,t.jsx)("tr",(0,f.Z)((0,f.Z)({},w),{},{ref:m,style:{height:y||"auto",boxSizing:"border-box"},children:F}))},ia=function(e){var a=e.children,s=(0,Ue.Z)(e,["children"]),y=(0,v.useContext)(Zt),n=y.renderLen,F=y.start,w=y.offsetStart,m=a[1],Z=null;return Array.isArray(m)&&m.length?Z=[a[0],m.slice(F,F+n).map(function(b){return Array.isArray(b)?b[0]:b})]:Z=a,(0,t.jsx)("tbody",(0,f.Z)((0,f.Z)({},s),{},{style:{transform:"translateY(-".concat(w,"px)")},children:Z}))},we=null,sa=function(e){var a,s,y,n,F=e.style,w=e.children,m=(0,Ue.Z)(e,["style","children"]),Z=(0,v.useReducer)(na,Lt),b=(0,S.Z)(Z,2),r=b[0],M=b[1],E=(0,v.useRef)(null),Y=(0,v.useState)((a=(s=w[1])===null||s===void 0||(y=s.props)===null||y===void 0||(n=y.data)===null||n===void 0?void 0:n.length)!==null&&a!==void 0?a:0),R=(0,S.Z)(Y,2),k=R[0],$=R[1];(0,v.useEffect)(function(){var N,o,g;if((N=w[1])!==null&&N!==void 0&&(o=N.props)!==null&&o!==void 0&&(g=o.data)!==null&&g!==void 0&&g.length){var c,d,u;$((c=w[1])===null||c===void 0||(d=c.props)===null||d===void 0||(u=d.data)===null||u===void 0?void 0:u.length)}},[w]);var D=(0,v.useMemo)(function(){var N="auto";return r.rowHeight&&k&&(N=r.rowHeight*k+10),N},[r.rowHeight,k]),H=0;if(typeof Tt=="string"){var U,G;H=(U=we.current)===null||U===void 0||(G=U.parentNode)===null||G===void 0?void 0:G.offsetHeight}else H=Tt;(0,ra.Z)(D)&&D<H&&(H=D),H<=0&&(H=0);var ae=(0,v.useMemo)(function(){var N=1;if(r.rowHeight&&k&&H)if(H<=0)N=0;else{var o=(H/r.rowHeight|0)+1+2;N=o>k?k:o}return N},[r.rowHeight,k,H]),K=r.rowHeight?r.curScrollTop/r.rowHeight|0:0,le=r.rowHeight?r.curScrollTop%r.rowHeight:0;return r.curScrollTop&&r.rowHeight&&r.curScrollTop>r.rowHeight?K>k-ae?le=0:K>1&&(K=K-1,le+=r.rowHeight):K=0,(0,v.useEffect)(function(){var N,o,g=(N=we)===null||N===void 0||(o=N.current)===null||o===void 0?void 0:o.parentNode;g&&(g.scrollTop=0),M({type:be.RESET})},[k]),(0,v.useEffect)(function(){var N,o,g=(0,aa.Z)(function(d){var u,h,x,I,P,L,Q=(u=d==null||(h=d.target)===null||h===void 0?void 0:h.scrollTop)!==null&&u!==void 0?u:0,A=(x=d==null||(I=d.target)===null||I===void 0?void 0:I.scrollHeight)!==null&&x!==void 0?x:0,X=(P=d==null||(L=d.target)===null||L===void 0?void 0:L.clientHeight)!==null&&P!==void 0?P:0;if(Q===A?He&&He():Q+X===A&&He&&He(),Q!==r.curScrollTop){var W=d.target.scrollHeight-H;M({type:be.RENDERTR,curScrollTop:Q,scrollHeight:W,tableScrollY:H})}},60),c=(N=we)===null||N===void 0||(o=N.current)===null||o===void 0?void 0:o.parentNode;return c&&c.addEventListener("scroll",g),function(){c==null||c.removeEventListener("scroll",g)}},[we,r.curScrollTop,H,r.scrollHeight]),(0,t.jsx)("div",{ref:we,style:{width:"100%",position:"relative",height:D,boxSizing:"border-box",paddingTop:r.curScrollTop},children:(0,t.jsx)(Zt.Provider,{value:{dispatch:M,start:K,offsetStart:le,renderLen:ae,totalLen:k,rowHeight:r.rowHeight},children:(0,t.jsx)("table",(0,f.Z)((0,f.Z)({},m),{},{ref:E,style:(0,f.Z)({width:"100%",position:"relative"},F),children:w}))})})},ua=function(e){var a=e.columns,s=e.scroll,y=e.sticky,n=e.pagination,F=e.editingKey,w=e.setEditingKey,m=e.form,Z=e.updatePoint,b=e.data,r=e.setData,M=e.active,E=e.rowKey,Y=e.clearEditable,R=e.wrapTableRef,k=e.timeDisplayForm,$=function(u){return u[E]===F},D=(0,v.useState)({}),H=(0,S.Z)(D,2),U=H[0],G=H[1],ae=v.useRef(null),K={ref:ae},le=function(u){var h=u.editing,x=u.dataIndex,I=u.title,P=u.inputType,L=u.record,Q=u.index,A=u.children,X=(0,Ue.Z)(u,["editing","dataIndex","title","inputType","record","index","children"]),W=P==="number"?(0,t.jsx)(St.Z,{}):(0,t.jsx)(ye.Z,{readOnly:U[x]!=!0,addonAfter:x!=null&&x.indexOf(".")<0?null:U[x]==!0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("a",{title:"unsave",children:(0,t.jsx)(_r.Z,{style:{color:"#fc4c2f"},onClick:function(){var te=(0,J.Z)(T().mark(function ce(Ie){var se;return T().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:se={},se[x]=L[x],m.setFieldsValue((0,f.Z)({},se)),U[x]=!1,G((0,f.Z)({},U));case 5:case"end":return de.stop()}},ce)}));return function(ce){return te.apply(this,arguments)}}()})}),(0,t.jsx)(ee.Z,{type:"vertical"}),(0,t.jsx)("a",{title:"save",onClick:function(){var te=(0,J.Z)(T().mark(function ce(Ie){var se,ge,de,$e,Ae,Ne;return T().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return oe.next=2,Z(L.Time,x,m.getFieldsValue()[x]);case 2:if(se=oe.sent,U[x]=!1,G((0,f.Z)({},U)),!(se!=null&&se.message!=null)){oe.next=22;break}if(se.code!="0"){oe.next=18;break}return oe.next=9,m.validateFields();case 9:ge=oe.sent,ge[x]=se.data,m.setFieldsValue((0,f.Z)({},ge)),de=(0,Me.Z)(b[M]),b[M]=de,$e=de.findIndex(function(De){return L[E]===De[E]}),$e>-1&&(Ae=de[$e],Ae[x]=ge[x],b[M]=de,r((0,f.Z)({},b))),oe.next=22;break;case 18:ie.default.error({message:se.message}),Ne={},Ne[x]=L[x],m.setFieldsValue((0,f.Z)({},Ne));case 22:case"end":return oe.stop()}},ce)}));return function(ce){return te.apply(this,arguments)}}(),children:(0,t.jsx)(ea.Z,{style:{color:"#1890ff"}})})]}):(0,t.jsx)("a",{title:"click to unlock",onClick:function(){U[x]=!0,G((0,f.Z)({},U))},children:(0,t.jsx)(ta.Z,{})})});return(0,t.jsx)("td",(0,f.Z)((0,f.Z)({},X),{},{children:h?(0,t.jsx)(Te.Z.Item,{name:x,style:{margin:0},rules:[],children:W}):A}))};a.length>1&&(a[0].render=function(d,u){return(0,t.jsxs)("span",{children:[b[M][u.index-1][a[0].key],(0,t.jsx)("div",{children:"\xA0"})]})},a[1].render=function(d,u){if(a[1].key=="Time"){var h=$(u);return h?(0,t.jsxs)("span",{children:[b[M][u.index-1].Time,(0,t.jsx)("div",{children:(0,t.jsx)(Nt.Z.Link,{onClick:o,children:"finish"})})]}):(0,t.jsxs)("span",{children:[k[M]=="utc"?Ht()(parseInt(b[M][u.index-1].Time)).utc().format("YYYY-MM-DD HH:mm:ss.SSS"):b[M][u.index-1].Time,(0,t.jsx)("div",{children:(0,t.jsx)(Nt.Z.Link,{onClick:function(){return N(u)},children:"edit"})})]})}else return b[M][u.index-1][a[1].key]});var N=function(){var d=(0,J.Z)(T().mark(function u(h){var x,I;return T().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return G({}),L.next=3,m.validateFields();case 3:x=L.sent,I={},Object.keys(h).map(function(Q,A){Q!=E&&(I[Q]=h[Q])}),Object.keys(a).map(function(Q,A){h[Q]==null&&(I[Q]=null)}),m.setFieldsValue((0,f.Z)({},I)),w(h[E]);case 9:case"end":return L.stop()}},u)}));return function(h){return d.apply(this,arguments)}}(),o=function(){Y()},g=function(){var d=(0,J.Z)(T().mark(function u(h){var x,I,P,L;return T().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.prev=0,A.next=3,m.validateFields();case 3:x=A.sent,I=(0,Me.Z)(b[M]),P=I.findIndex(function(X){return h[E]===X[E]}),P>-1?(L=I[P],I.splice(P,1,(0,f.Z)((0,f.Z)({},L),x)),b[M]=I,r((0,f.Z)({},b))):(I.push(x),b[M]=I,r((0,f.Z)({},b))),A.next=12;break;case 9:A.prev=9,A.t0=A.catch(0),console.log("Validate Failed:",A.t0);case 12:Y();case 13:case"end":return A.stop()}},u,null,[[0,9]])}));return function(h){return d.apply(this,arguments)}}(),c=a.map(function(d){return d.editable?(0,f.Z)((0,f.Z)({},d),{},{onCell:function(h){return{record:h,inputType:"text",dataIndex:d.dataIndex,title:d.title,editing:$(h)}}}):d});return(0,t.jsx)(Te.Z,{form:m,component:!1,children:(0,t.jsx)(_e.Z,{components:Qt({height:450,cell:le,wrapTableRef:R}),bordered:!0,rowKey:E,dataSource:b[M],columns:c,rowClassName:"editable-row",scroll:s,sticky:y,pagination:n})})},Qt=function(e){return Tt=e.height,He=e.onReachEnd,we=e.wrapTableRef,{table:sa,body:{wrapper:ia,row:la,cell:e.cell}}},oa=function(e){return ua(e)},ca=l(69610),da=l(54941),fa=l(81306),ma=l(59206),va=function(i){(0,fa.Z)(a,i);var e=(0,ma.Z)(a);function a(){return(0,ca.Z)(this,a),e.apply(this,arguments)}return(0,da.Z)(a,[{key:"render",value:function(){return this.props.addonAfter?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(St.Z,(0,f.Z)({style:{borderBottomRightRadius:0,borderTopRightRadius:0}},this.props)),(0,t.jsx)("div",{className:"ant-input-group-addon",style:{marginTop:"-4px",paddingTop:"2px",display:"inline-table",lineHeight:"24px",height:"32px"},children:this.props.addonAfter})]}):(0,t.jsx)(St.Z,(0,f.Z)({},this.props))}}]),a}(v.Component),pa=l(53667),ha=l.n(pa),zt=tt.Z.Option,ya=function(){var e=(0,ne.YB)(),a=(0,ne.tT)("@@initialState"),s=a.initialState,y=a.setInitialState,n=(0,v.useState)({query1:"SHOW STORAGE GROUP"}),F=(0,S.Z)(n,2),w=F[0],m=F[1],Z=(0,v.useState)("query1"),b=(0,S.Z)(Z,2),r=b[0],M=b[1],E=(0,v.useRef)("query1");(0,v.useEffect)(function(){E.current=r},[r]);var Y=(0,v.useState)(!1),R=(0,S.Z)(Y,2),k=R[0],$=R[1],D=(0,v.useState)(!1),H=(0,S.Z)(D,2),U=H[0],G=H[1],ae=(0,v.useState)(void 0),K=(0,S.Z)(ae,2),le=K[0],N=K[1],o=(0,v.useState)(!1),g=(0,S.Z)(o,2),c=g[0],d=g[1],u=(0,v.useState)(!1),h=(0,S.Z)(u,2),x=h[0],I=h[1],P=(0,v.useState)(!1),L=(0,S.Z)(P,2),Q=L[0],A=L[1],X=(0,v.useState)({}),W=(0,S.Z)(X,2),te=W[0],ce=W[1],Ie=(0,v.useRef)([]);(0,v.useEffect)(function(){Ie.current=te},[te]);var se=(0,v.useRef)(null),ge=null,de=(0,t.jsx)(At.Rt,{value:w[r],options:(0,yr.Z)({mode:"text/iotdb-sql",theme:"juejin",autofocus:!0,lineNumbers:!0,tabindex:1,extraKeys:{"Alt-/":"autocomplete","Cmd-/":"toggleComment","Ctrl-/":"toggleComment","Shift-Cmd-F":function(){cr()},"Shift-Ctrl-F":function(){cr()},F8:function(){Ct()}},matchBrackets:!0,readOnly:k,indentWithTabs:!0,smartIndent:!0,hintOptions:{completeSingle:!1}},"autofocus",!1),onChange:function(p,q,C){q.origin!=null&&(q.removed[0].trim()!=""||q.text[0].match(/^[a-zA-Z0-9_]+$/))&&p.showHint(),w[r]=C}}),$e=(0,v.useState)({tabActiveKey:"tab1",operationKey:"query1"}),Ae=(0,S.Z)($e,2),Ne=Ae[0],Gt=Ae[1],oe=(0,v.useState)({}),De=(0,S.Z)(oe,2),ve=De[0],Le=De[1],qe=(0,v.useRef)([]);(0,v.useEffect)(function(){qe.current=ve},[ve]);var xa=(0,v.useState)([]),Vt=(0,S.Z)(xa,2),fe=Vt[0],We=Vt[1],Se=(0,v.useRef)([]);(0,v.useEffect)(function(){Se.current=fe},[fe]);var ba=(0,v.useState)([]),Ut=(0,S.Z)(ba,2),xe=Ut[0],Qe=Ut[1],pe=(0,v.useRef)([]);(0,v.useEffect)(function(){pe.current=xe},[xe]);var Sa=(0,v.useState)([]),Dt=(0,S.Z)(Sa,2),he=Dt[0],Wt=Dt[1],Za=(0,v.useState)([]),Bt=(0,S.Z)(Za,2),Ze=Bt[0],Ta=Bt[1],ja=(0,v.useState)([]),Yt=(0,S.Z)(ja,2),jt=Yt[0],qa=Yt[1],Ca=(0,v.useState)([]),Kt=(0,S.Z)(Ca,2),ze=Kt[0],Ma=Kt[1],ka=(0,v.useState)([{}]),Jt=(0,S.Z)(ka,2),Pn=Jt[0],On=Jt[1],wa=(0,v.useState)(""),Xt=(0,S.Z)(wa,2),Ra=Xt[0],_t=Xt[1],Ea=(0,v.useState)({}),er=(0,S.Z)(Ea,2),Re=er[0],tr=er[1],Fa=(0,v.useState)([]),rr=(0,S.Z)(Fa,2),Be=rr[0],Pa=rr[1],Oa=Te.Z.useForm(),Ha=(0,S.Z)(Oa,1),qt=Ha[0],Ee=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ee.Z,{type:"vertical"}),(0,t.jsxs)("span",{children:[e.formatMessage({id:"query.result.locate.text"})," "]}),(0,t.jsx)(va,{style:{width:170,size:"small"},placeholder:"index or Time..",min:0,max:9223372036854776e3,onChange:function(p){Be[r]=p,Pa((0,f.Z)({},Be))},onPressEnter:function(){ar()},addonAfter:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("a",{onClick:function(){ar()},children:"index "}),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.locate.or"}),(0,t.jsx)(ee.Z,{type:"vertical"}),(0,t.jsx)("a",{onClick:function(){Aa()},children:"Time "})]})}),(0,t.jsx)(ee.Z,{type:"vertical"}),(0,t.jsxs)(tt.Z,{placeholder:e.formatMessage({id:"query.result.time.displayAs"}),style:{width:140},onChange:function(p){$a(p)},children:[(0,t.jsx)(zt,{value:"number",children:"Number"}),(0,t.jsx)(zt,{value:"utc",children:"UTC"})]}),(0,t.jsx)(ee.Z,{type:"vertical"}),(0,t.jsx)("a",{onClick:function(){var p=Se.current[r].map(function(q,C){return q.title}).filter(function(q){return q!="index"});Ia(r,p,pe.current[r])},children:e.formatMessage({id:"query.result.download"})})]}),Ia=function(p,q,C){var j={};j.fileName=p;var V=q.map(function(z,mr){return 10});j.datas=[{sheetData:C,sheetName:p,sheetFilter:q,sheetHeader:q,columnWidths:V}];var re=new(ha())(j);re.saveExcel()},$a=function(p){jt[r]=p,qa((0,f.Z)({},jt))},ar=function(){Re[r]=Be[r],tr((0,f.Z)({},Re)),nr()},Aa=function(){if(Se.current[r][1].title=="Time"){var p=pe.current[r].find(function(q){return q.Time>=Be[r]});p=p==null?pe.current[r][pe.current[r].length-1]:p,Re[r]=p.index,tr((0,f.Z)({},Re)),nr()}},nr=function(){var p=Re[r]==null?0:Re[r];p=p<1?1:p;var q=77*(p-1);se.current.parentNode.scrollTop=q},lr=function(){var O=(0,J.Z)(T().mark(function p(){var q,C,j,V,re,z;return T().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return qe.current[r]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(r," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(Ze[r]," ms"),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(he[r]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.load.ing"})]}),Ee]}),q=(0,bt.v4)().replaceAll("-",""),te[E.current]=q,ce((0,f.Z)({},te)),B.next=6,Rr({queryToken:ze[r],tabKey:E.current,tabToken:q});case 6:if(C=B.sent,C.code!="0"){B.next=25;break}if(fe[r]=[],j=JSON.parse(C.message||"{}"),j.tabToken==Ie.current[j.tabKey]){B.next=13;break}return ie.default.error({message:e.formatMessage({id:"query.result.expired"})}),B.abrupt("return");case 13:for(V=C.data==null?[]:C.data,re=pe.current[r].length,he[r]=re+V.length,Wt((0,f.Z)({},he)),j.hasMore?qe.current[r]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(r," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(Ze[r]," ms"),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(he[r]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ee.Z,{type:"vertical"})]}),(0,t.jsx)("a",{onClick:function(){lr()},children:e.formatMessage({id:"query.result.load.next"})}),Ee]}):qe.current[r]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(r," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(Ze[r]," ms"),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(he[r]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.load.done"})]}),Ee]}),Le((0,f.Z)({},qe.current)),z=0;z<V.length;z++)Object.keys(V[z]).map(function(_,Pe){if(Se.current[r][_]==null){var ue={title:_,editable:!0,dataIndex:_,width:200,key:_,render:function(Da){return Da}};Se.current[r][_]=ue,Se.current[r][Se.current[r].length]=ue}}),V[z].index=re+z+1,pe.current[r][re+z]=V[z];pe.current[r]=pe.current[r].slice(),We((0,f.Z)({},Se.current)),Qe((0,f.Z)({},pe.current)),B.next=26;break;case 25:C.message!=null&&(qe.current[r]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(r," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(Ze[r]," ms"),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(he[r]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ee.Z,{type:"vertical"}),"".concat(C.message)]}),Ee]}),Le((0,f.Z)({},qe.current)));case 26:case"end":return B.stop()}},p)}));return function(){return O.apply(this,arguments)}}(),Na=function(p,q){p.preventDefault();for(var C=Ke,j=0;j<C.length;j++)if(C[j]!=null&&C[j].key=="query"+q){C[j]=null;break}C=C.filter(function(V){return V!=null}),sr(C),Ge(),M("queryPlus"),Xe("Plus"),$(!0)},Ye=1,La=(0,v.useState)([{key:"query1",tab:(0,t.jsx)("span",{onClick:function(){M("query1"),Xe(1),Ge()},children:e.formatMessage({id:"query.query.text"})+"1"})},{key:"queryPlus",tab:(0,t.jsx)(xr.Z,{onClick:function(p,q){if(Ye==100){alert(e.formatMessage({id:"query.query.rule"}));return}Ye+=1;var C=Ke,j=Ke.length;C[j]=C[j-1],C[j-1]={key:"query"+Ye,tab:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{onClick:function(){M("query"+j),Xe(j),Ge()},children:[e.formatMessage({id:"query.query.text"})+Ye," "]}),(0,t.jsx)(wt.Z,{title:"Sure to delete?",onConfirm:function(re){Na(re,j)},children:(0,t.jsx)(br.Z,{style:{cursor:"default"},title:"delete"})})]})},C=C.filter(function(V){return V!=null}),sr(C),M("query"+j),Xe(j)}})}]),ir=(0,S.Z)(La,2),Ke=ir[0],sr=ir[1],ur=me.Z.Group,Je=function(){return r=="queryPlus"||k?(alert(e.formatMessage({id:"query.query.description"})),!0):!1},Ge=function(){var p={};Object.keys(qt.getFieldsValue()).map(function(q,C){p[q]=null}),qt.setFieldsValue((0,f.Z)({},p)),_t("")},Ct=function(){var O=(0,J.Z)(T().mark(function p(){var q,C,j,V,re,z;return T().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(Ge(),!Je()){B.next=3;break}return B.abrupt("return");case 3:return ve[r]=null,Le((0,f.Z)({},ve)),fe[r]=[],We((0,f.Z)({},fe)),xe[r]=[],Qe((0,f.Z)({},xe)),ze[r]==null&&(q=(0,bt.v4)().replaceAll("-",""),ze[r]=q,Ma((0,f.Z)({},ze))),C=w[E.current],w[E.current]=w[E.current],j=(0,bt.v4)().replaceAll("-",""),te[E.current]=j,ce((0,f.Z)({},te)),B.next=18,wr({sqls:C,queryToken:ze[r],tabKey:E.current,tabToken:j});case 18:if(V=B.sent,V.code!="0"){B.next=34;break}if(re=JSON.parse(V.message||"{}"),re.tabToken==Ie.current[re.tabKey]){B.next=24;break}return ie.default.error({message:e.formatMessage({id:"query.result.expired"})}),B.abrupt("return");case 24:z=V.data==null?[]:V.data,Ze[r]=re.costMilliSecond==null?0:re.costMilliSecond,Ta((0,f.Z)({},Ze)),he[r]=z.length,Wt(he),re.hasMore?ve[r]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(r," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(Ze[r]," ms"),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(he[r]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ee.Z,{type:"vertical"})]}),(0,t.jsx)("a",{onClick:function(){lr()},children:e.formatMessage({id:"query.result.load.next"})}),Ee]}):ve[r]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(r," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(Ze[r]," ms"),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(he[r]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ee.Z,{type:"vertical"}),"".concat(z.length==0?e.formatMessage({id:"query.result.execute.done"}):e.formatMessage({id:"query.result.load.done"}))]}),(0,t.jsx)("span",{children:Ee})]}),Le((0,f.Z)({},ve)),z.length==0?(fe[r]=[],We((0,f.Z)({},fe)),xe[r]=[],Qe((0,f.Z)({},xe))):function(){for(var _=[],Pe=0;Pe<z.length;Pe++)_.index==null&&(_.index={title:"index",editable:!1,dataIndex:"index",width:70,key:"index",fixed:"left"},_[_.length]=_.index),Object.keys(z[Pe]).map(function(ue,Ua){_[ue]==null&&(_[ue]={title:ue,editable:!(ue=="Time"||ue=="Device"),dataIndex:ue,width:190,key:ue,fixed:ue=="Time"||ue=="Device"?"left":!1},_[_.length]=_[ue])}),z[Pe].index=Pe+1;fe[r]=_,We((0,f.Z)({},fe)),xe[r]=z.slice(),Qe((0,f.Z)({},xe))}(),B.next=37;break;case 34:ve[r]=r+" "+e.formatMessage({id:"query.result.execute.failed"}),Le((0,f.Z)({},ve)),ie.default.error({message:V.message});case 37:case"end":return B.stop()}},p)}));return function(){return O.apply(this,arguments)}}(),or=function(){Je()||d(!0)},cr=function(){var p=(0,Xr.WU)(w[r]);w[r]="",m((0,f.Z)({},w)),w[r]=p,m((0,f.Z)({},w))},Qa=function(){var O=(0,J.Z)(T().mark(function p(q,C,j){var V;return T().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(!Je()){z.next=2;break}return z.abrupt("return");case 2:return z.next=5,Fr({point:C,value:j,timestamp:q});case 5:return V=z.sent,z.abrupt("return",V);case 7:case"end":return z.stop()}},p)}));return function(q,C,j){return O.apply(this,arguments)}}(),dr=function(){var O=(0,J.Z)(T().mark(function p(){var q;return T().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!Je()){j.next=2;break}return j.abrupt("return");case 2:return j.next=5,Pt({pageSize:10,pageNum:1});case 5:q=j.sent,Oe.dealCallback(q,function(V){var re=0;V.data.pageItems.map(function(z){z.key=re++}),N(V.data),G(!0)},ie.default);case 7:case"end":return j.stop()}},p)}));return function(){return O.apply(this,arguments)}}(),za=function(p){if(p.queryCommand==null||p.queryCommand.trim()==""){ie.default.error({message:e.formatMessage({id:"query.sql.export.required"})});return}var q="/api/query/exportCsv?sqls="+p.queryCommand+"&timeformat="+p.timeformat+"&timeZone="+p.timeZone+"&compress="+p.compress+"&targetFile="+(p.targetFile==null?"dump":p.targetFile);Oe.download2(q)},Ga=(0,t.jsx)(qr.Z.Consumer,{children:function(p){var q=p.isMobile;return q?(0,t.jsx)(v.Fragment,{children:(0,t.jsxs)(ur,{children:[(0,t.jsxs)(me.Z,{onClick:or,children:[(0,t.jsx)(Rt.Z,{}),e.formatMessage({id:"query.sql.script.save"})]}),(0,t.jsxs)(me.Z,{onClick:dr,children:[(0,t.jsx)(Et.Z,{}),e.formatMessage({id:"query.sql.script.view"})]}),(0,t.jsxs)(me.Z,{onClick:Ct,type:"primary",children:[(0,t.jsx)(Ft.Z,{}),e.formatMessage({id:"query.sql.execute"})]})]})}):(0,t.jsxs)(v.Fragment,{children:[(0,t.jsx)(hr.Z,{title:(0,t.jsxs)("span",{children:[e.formatMessage({id:"query.sql.tooltip1"}),(0,t.jsx)("br",{}),e.formatMessage({id:"query.sql.tooltip2"}),(0,t.jsx)("br",{}),e.formatMessage({id:"query.sql.tooltip3"}),(0,t.jsx)("br",{}),e.formatMessage({id:"query.sql.tooltip4"})]}),children:(0,t.jsx)(Sr.Z,{})}),(0,t.jsxs)(ur,{children:[(0,t.jsxs)(me.Z,{onClick:Ct,type:"primary",children:[(0,t.jsx)(Ft.Z,{}),e.formatMessage({id:"query.sql.execute"})]}),(0,t.jsxs)(me.Z,{onClick:or,children:[(0,t.jsx)(Et.Z,{}),e.formatMessage({id:"query.sql.script.save"})]}),(0,t.jsxs)(pr.Z.Button,{trigger:["hover"],onClick:dr,icon:(0,t.jsx)(Zr.Z,{}),overlay:(0,t.jsxs)(et.Z,{children:[(0,t.jsxs)(et.Z.Item,{onClick:function(){I(!0)},children:[(0,t.jsx)(Tr.Z,{})," ",e.formatMessage({id:"query.sql.export"})]},"exportCsv"),(0,t.jsxs)(et.Z.Item,{onClick:function(){A(!0)},children:[(0,t.jsx)(jr.Z,{})," ",e.formatMessage({id:"query.sql.import"})]},"importCsv")]}),placement:"bottomRight",children:[(0,t.jsx)(Rt.Z,{}),e.formatMessage({id:"query.sql.script.view"})]})]})]})}}),Va={},fr=Va.loading;ge={queryPlus:(0,t.jsx)(_e.Z,{pagination:!1,loading:fr,dataSource:[],columns:[],scroll:{y:450,scrollToFirstRowOnChange:!1},sticky:!1,components:Qt({height:450})})};for(var Fe=1;Fe<100;Fe++)ge["query"+Fe]=(0,t.jsx)(oa,{rowKey:"index",loading:fr,columns:fe["query"+Fe]==null?[]:fe["query"+Fe],scroll:{y:450,scrollToFirstRowOnChange:!1},sticky:!1,pagination:!1,data:xe,setData:Qe,active:"query"+Fe,editingKey:Ra,setEditingKey:_t,form:qt,clearEditable:Ge,updatePoint:Qa,wrapTableRef:se,timeDisplayForm:jt});var Xe=function(p){$(!1),Gt({tabActiveKey:"tab"+p,operationKey:"query"+p})};return(0,t.jsxs)(Cr.ZP,{title:s.activeConnectionDesc,extra:Ga,className:je().pageHeader,content:de,tabList:Ke,tabActiveKey:r,children:[(0,t.jsx)("div",{className:je().main,children:(0,t.jsx)(Mr.Z,{children:(0,t.jsx)(vr.Z,{id:"s",className:je().tabsCard,title:ve[r],bordered:!1,children:ge[Ne.operationKey]})})}),(0,t.jsx)(zr,{visible:U,setVisible:G,content:le,setContent:N,querySql:w,setQuerySql:m,activeQueryTabkey:r}),(0,t.jsx)(Vr,{visible:c,setVisible:d,querySql:w,activeQueryTabkey:r}),(0,t.jsx)(Br,{visible:x,setVisible:I,exportCsv:za,activeQueryTabkey:r}),(0,t.jsx)(Jr,{destroyOnClose:!0,visible:Q,setVisible:A,activeQueryTabkey:r})]})},ga=ya}}]);

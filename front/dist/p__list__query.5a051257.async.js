(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[2741],{55026:function(Mt){Mt.exports={main:"main___31kpQ",headerList:"headerList___2mK7o",stepDescription:"stepDescription___15qRg",pageHeader:"pageHeader___3Ha2b",moreInfo:"moreInfo___2mXTE"}},8778:function(Mt,kt,l){"use strict";l.r(kt),l.d(kt,{default:function(){return xa}});var Ja=l(72012),pr=l(39144),Xa=l(66456),Xe=l(85453),_a=l(59250),hr=l(13013),en=l(30887),_e=l(99210),tn=l(22385),yr=l(69713),rn=l(57663),ve=l(71577),an=l(62350),wt=l(75443),nn=l(74379),le=l(38648),J=l(3182),f=l(11849),ln=l(48736),ee=l(27049),sn=l(9715),Te=l(86585),gr=l(32059),Z=l(2824),un=l(43358),et=l(90290),xr=l(94043),j=l.n(xr),br=l(1977),Sr=l(73218),Rt=l(92104),Et=l(47760),Ft=l(29934),Zr=l(1870),Tr=l(44545),jr=l(20924),qr=l(65233),Cr=l(64335),Mr=l(15103),kr=l(21349),v=l(67294),ae=l(58086);function on(){return tt.apply(this,arguments)}function tt(){return tt=_asyncToGenerator(_regeneratorRuntime.mark(function i(){return _regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",request("/api/profile/advanced"));case 1:case"end":return r.stop()}},i)})),tt.apply(this,arguments)}var ke=l(91896);function cn(i,e){return rt.apply(this,arguments)}function rt(){return rt=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,r){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/all",_objectSpread({method:"GET",params:_objectSpread({},s)},r||{})));case 2:case"end":return n.stop()}},i)})),rt.apply(this,arguments)}function Pt(i,e){return at.apply(this,arguments)}function at(){return at=(0,J.Z)(j().mark(function i(e,r){var s;return j().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=(0,ke.Z)({},e),n.abrupt("return",(0,ae.WY)("/api/query/all",(0,f.Z)({method:"POST",params:(0,f.Z)({},s)},r||{})));case 2:case"end":return n.stop()}},i)})),at.apply(this,arguments)}function dn(i,e){return nt.apply(this,arguments)}function nt(){return nt=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,r){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/deleteThenReturnAll",_objectSpread({method:"GET",params:_objectSpread({},s)},r||{})));case 2:case"end":return n.stop()}},i)})),nt.apply(this,arguments)}function wr(i,e){return lt.apply(this,arguments)}function lt(){return lt=(0,J.Z)(j().mark(function i(e,r){var s;return j().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=(0,ke.Z)({},e),n.abrupt("return",(0,ae.WY)("/api/query/deleteThenReturnAll",(0,f.Z)({method:"POST",params:(0,f.Z)({},s)},r||{})));case 2:case"end":return n.stop()}},i)})),lt.apply(this,arguments)}function fn(i,e){return it.apply(this,arguments)}function it(){return it=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,r){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/exportCsv",_objectSpread({method:"GET",params:_objectSpread({},s)},r||{})));case 2:case"end":return n.stop()}},i)})),it.apply(this,arguments)}function mn(i,e){return st.apply(this,arguments)}function st(){return st=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,r){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/exportCsv",_objectSpread({method:"POST",params:_objectSpread({},s)},r||{})));case 2:case"end":return n.stop()}},i)})),st.apply(this,arguments)}function vn(i,e,r,s){return ut.apply(this,arguments)}function ut(){return ut=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,r,s,g){var n,F;return _regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return n=_extends({},e),F=new FormData,s&&F.append("Filedata",s[0]||""),Object.keys(r).forEach(function(T){var S=r[T];S!=null&&F.append(T,typeof S=="object"?JSON.stringify(S):S)}),m.abrupt("return",request("/api/query/importCsv",_objectSpread({method:"POST",headers:{"Content-Type":"multipart/form-data"},params:_objectSpread({},n),data:F},g||{})));case 5:case"end":return m.stop()}},i)})),ut.apply(this,arguments)}function pn(i,e){return ot.apply(this,arguments)}function ot(){return ot=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,r){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/querySql",_objectSpread({method:"GET",params:_objectSpread({},s)},r||{})));case 2:case"end":return n.stop()}},i)})),ot.apply(this,arguments)}function Rr(i,e){return ct.apply(this,arguments)}function ct(){return ct=(0,J.Z)(j().mark(function i(e,r){var s;return j().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=(0,ke.Z)({},e),n.abrupt("return",(0,ae.WY)("/api/query/querySql",(0,f.Z)({method:"POST",params:(0,f.Z)({},s)},r||{})));case 2:case"end":return n.stop()}},i)})),ct.apply(this,arguments)}function hn(i,e){return dt.apply(this,arguments)}function dt(){return dt=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,r){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/querySqlAppend",_objectSpread({method:"GET",params:_objectSpread({},s)},r||{})));case 2:case"end":return n.stop()}},i)})),dt.apply(this,arguments)}function Er(i,e){return ft.apply(this,arguments)}function ft(){return ft=(0,J.Z)(j().mark(function i(e,r){var s;return j().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=(0,ke.Z)({},e),n.abrupt("return",(0,ae.WY)("/api/query/querySqlAppend",(0,f.Z)({method:"POST",params:(0,f.Z)({},s)},r||{})));case 2:case"end":return n.stop()}},i)})),ft.apply(this,arguments)}function yn(i,e){return mt.apply(this,arguments)}function mt(){return mt=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,r){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/save",_objectSpread({method:"GET",params:_objectSpread({},s)},r||{})));case 2:case"end":return n.stop()}},i)})),mt.apply(this,arguments)}function Fr(i,e){return vt.apply(this,arguments)}function vt(){return vt=(0,J.Z)(j().mark(function i(e,r){var s;return j().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=(0,ke.Z)({},e),n.abrupt("return",(0,ae.WY)("/api/query/save",(0,f.Z)({method:"POST",params:(0,f.Z)({},s)},r||{})));case 2:case"end":return n.stop()}},i)})),vt.apply(this,arguments)}function gn(i,e){return pt.apply(this,arguments)}function pt(){return pt=_asyncToGenerator(_regeneratorRuntime.mark(function i(e,r){var s;return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=_extends({},e),n.abrupt("return",request("/api/query/updatePoint",_objectSpread({method:"GET",params:_objectSpread({},s)},r||{})));case 2:case"end":return n.stop()}},i)})),pt.apply(this,arguments)}function Pr(i,e){return ht.apply(this,arguments)}function ht(){return ht=(0,J.Z)(j().mark(function i(e,r){var s;return j().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=(0,ke.Z)({},e),n.abrupt("return",(0,ae.WY)("/api/query/updatePoint",(0,f.Z)({method:"POST",params:(0,f.Z)({},s)},r||{})));case 2:case"end":return n.stop()}},i)})),ht.apply(this,arguments)}var Or=l(55026),je=l.n(Or);function Hr(i,e,r){r!=null&&(i==null||i.code!="0")?r.error({message:i.message}):e(i)}function Ar(i,e){var r=URL.createObjectURL(new Blob([i])),s=document.createElement("a");s.style.display="none",s.href=r,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s)}function Ir(i){var e=document.createElement("a");e.style.display="none",e.href=i,document.body.appendChild(e),e.click(),document.body.removeChild(e)}var Ae={dealCallback:Hr,download:Ar,download2:Ir},we=l(86582),xn=l(49111),$r=l(19650),bn=l(47673),ge=l(4107),Ge=l(37476),Nr=l(59879),Ot=l(43061),Qr=l(30381),Ht=l.n(Qr),t=l(85893),Lr=ge.Z.Search,Sn=ge.Z.TextArea,zr=function(e){var r=(0,ae.YB)(),s=e.done,g=e.visible,n=e.content,F=e.setContent,R=e.querySql,m=e.activeQueryTabkey,T=e.setQuerySql,S=e.setVisible,h=(0,ae.tT)("@@initialState"),P=h.initialState,U=h.setInitialState,B=(0,v.useState)(void 0),a=(0,Z.Z)(B,2),q=a[0],k=a[1],D=et.Z.Option,H=Te.Z.useForm(),z=(0,Z.Z)(H,1),G=z[0],re=(0,ae.QT)((0,J.Z)(j().mark(function d(){return j().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:case"end":return y.stop()}},d)}))),K=re.data,ne=re.loading,$=re.mutate,o=function(){var d=(0,J.Z)(j().mark(function u(y,b,A){var O;return j().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,Pt({pageSize:10,pageNum:y,nameLike:A});case 2:O=Q.sent,Ae.dealCallback(O,function(I){var X=0;I.data.pageItems.map(function(W){W.key=X++}),F(I.data)},le.default);case 4:case"end":return Q.stop()}},u)}));return function(y,b,A){return d.apply(this,arguments)}}(),x=function(){var d=(0,J.Z)(j().mark(function u(y){var b;return j().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,wr({queryId:y.id,pageSize:10,pageNum:1,nameLike:q});case 2:b=O.sent,Ae.dealCallback(b,function(N){var Q=0;N.data.pageItems.map(function(I){I.key=Q++}),F(N.data)},le.default);case 4:case"end":return O.stop()}},u)}));return function(y){return d.apply(this,arguments)}}(),c=[{title:r.formatMessage({id:"query.sql.script.name"}),dataIndex:"name",key:"name",width:"20%",render:function(u){return(0,t.jsx)("div",{children:u})}},{title:"SQL",dataIndex:"sqls",key:"sqls",width:"45%",render:function(u){return(0,t.jsx)("div",{children:u})}},{title:r.formatMessage({id:"query.sql.script.createTime"}),dataIndex:"createTime",key:"createTime",width:"20%",render:function(u){return(0,t.jsx)(t.Fragment,{children:Ht()(parseInt(u)).format("YYYY-MM-DD HH:mm")})}},{title:r.formatMessage({id:"pages.operation.text"}),key:"action",render:function(u,y){return(0,t.jsxs)($r.Z,{size:"middle",children:[(0,t.jsx)("a",{onClick:function(A){R[m]=y.sqls,T((0,f.Z)({},R)),S(!1)},children:r.formatMessage({id:"pages.use.text"})}),(0,t.jsx)(wt.Z,{placement:"left",title:y.name+" -- "+r.formatMessage({id:"pages.delete.confirm"}),onConfirm:function(A){return x(y,A)},children:(0,t.jsx)("a",{children:r.formatMessage({id:"pages.delete.text"})})})]})}}];return g?(0,t.jsx)(Ge.Z,{visible:g,form:G,title:r.formatMessage({id:"query.sql.script.view"}),className:je().standardListForm,initialValues:n.pageItems,submitter:{submitButtonProps:{style:{display:"none"}},render:function(u,y){return(0,we.Z)(y)}},modalProps:{onCancel:function(){return S(!1)},destroyOnClose:!0,bodyStyle:s?{padding:"72px 0"}:{}},children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{textAlign:"right",marginBottom:"10px",marginTop:"-10px"},children:(0,t.jsxs)(ve.Z.Group,{children:[(0,t.jsxs)(ve.Z,{value:"all",onClick:function(){k(null),o(1,10)},children:[(0,t.jsx)(Nr.Z,{}),r.formatMessage({id:"pages.refresh.text"})]}),(0,t.jsx)(Lr,{style:{width:"190px"},placeholder:r.formatMessage({id:"pages.refresh.placeholder"}),onSearch:function(u){o(1,10,u)},onChange:function(u){k(u.target.value)},value:q,suffix:q==null||q==""?(0,t.jsx)(Ot.Z,{style:{display:"none"}}):(0,t.jsx)(Ot.Z,{style:{color:"rgba(0,0,0,.45)"},onClick:function(){k(null)}})})]})}),(0,t.jsx)(Xe.Z,{columns:c,dataSource:n.pageItems,pagination:{showSizeChanger:!1,showQuickJumper:!0,pageSize:10,current:n==null?1:n.pageNo,total:n==null?1:n.totalCount,onChange:function(u,y){o(u,y,q)}}})]})}):null},Gr=zr,At=l(5966),Zn=ge.Z.Search,Tn=ge.Z.TextArea,Vr=function(e){var r=(0,ae.YB)(),s=e.done,g=e.visible,n=e.setVisible,F=e.querySql,R=e.activeQueryTabkey,m=Te.Z.useForm(),T=(0,Z.Z)(m,1),S=T[0],h=(0,ae.QT)((0,J.Z)(j().mark(function q(){return j().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:case"end":return D.stop()}},q)}))),P=h.data,U=h.loading,B=h.mutate,a=function(){var q=(0,J.Z)(j().mark(function k(D){var H;return j().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,Fr({sqls:F[R],name:D});case 2:H=G.sent,Ae.dealCallback(H,function(re){le.default.success({message:r.formatMessage({id:"query.sql.script.save.success"})+" "+D}),n(!1)},le.default);case 4:case"end":return G.stop()}},k)}));return function(D){return q.apply(this,arguments)}}();return g?(0,t.jsx)(Ge.Z,{visible:g,form:S,title:r.formatMessage({id:"query.sql.script.create"}),className:je().standardListForm,submitter:{render:function(k,D){return(0,we.Z)(D)}},onFinish:function(k){a(k.name)},modalProps:{onCancel:function(){return n(!1)},destroyOnClose:!0,bodyStyle:s?{padding:"72px 0"}:{}},children:(0,t.jsx)(At.Z,{name:"name",label:r.formatMessage({id:"query.sql.script.name"}),rules:[{required:!0}]})}):null},Ur=Vr,jn=l(13062),yt=l(71230),qn=l(89032),Re=l(15746),gt=l(86615),It=l(64317),$t=l(29656),Dr=l(4631),Wr=l.n(Dr);(function(i){typeof exports=="object"?i(l(4631)):typeof define=="function"&&l.amdO?define(["../../../node_modules/codemirror/lib/codemirror"],i):i(Wr())})(function(i){"use strict";i.defineMode("iotdb-sql",function(m,T){var S=T.client||{},h=T.atoms||{false:!0,true:!0,null:!0},P=T.builtin||F(R),U=T.keywords||F(n),B=T.operatorChars||/^[*+\-%<>!=&|~^\/]/,a=T.support||{},q=T.hooks||{},k=T.dateSQL||{date:!0,time:!0,timestamp:!0},D=T.backslashStringEscapes!==!1,H=T.brackets||/^[\{}\(\)\[\]]/,z=T.punctuation||/^[;.,:]/;function G(o,x){var c=o.next();if(q[c]){var d=q[c](o,x);if(d!==!1)return d}if(a.hexNumber&&(c=="0"&&o.match(/^[xX][0-9a-fA-F]+/)||(c=="x"||c=="X")&&o.match(/^'[0-9a-fA-F]+'/)))return"number";if(a.binaryNumber&&((c=="b"||c=="B")&&o.match(/^'[01]+'/)||c=="0"&&o.match(/^b[01]+/)))return"number";if(c.charCodeAt(0)>47&&c.charCodeAt(0)<58)return o.match(/^[0-9]*(\.[0-9]+)?([eE][-+]?[0-9]+)?/),a.decimallessFloat&&o.match(/^\.(?!\.)/),"number";if(c=="?"&&(o.eatSpace()||o.eol()||o.eat(";")))return"variable-3";if(c=="'"||c=='"'&&a.doubleQuote)return x.tokenize=re(c),x.tokenize(o,x);if((a.nCharCast&&(c=="n"||c=="N")||a.charsetCast&&c=="_"&&o.match(/[a-z][a-z0-9]*/i))&&(o.peek()=="'"||o.peek()=='"'))return"keyword";if(a.escapeConstant&&(c=="e"||c=="E")&&(o.peek()=="'"||o.peek()=='"'&&a.doubleQuote))return x.tokenize=function(y,b){return(b.tokenize=re(y.next(),!0))(y,b)},"keyword";if(a.commentSlashSlash&&c=="/"&&o.eat("/"))return o.skipToEnd(),"comment";if(a.commentHash&&c=="#"||c=="-"&&o.eat("-")&&(!a.commentSpaceRequired||o.eat(" ")))return o.skipToEnd(),"comment";if(c=="/"&&o.eat("*"))return x.tokenize=K(1),x.tokenize(o,x);if(c=="."){if(a.zerolessFloat&&o.match(/^(?:\d+(?:e[+-]?\d+)?)/i))return"number";if(o.match(/^\.+/))return null;if(a.ODBCdotTable&&o.match(/^[\w\d_$#]+/))return"variable-2"}else{if(B.test(c))return o.eatWhile(B),"operator";if(H.test(c))return"bracket";if(z.test(c))return o.eatWhile(z),"punctuation";if(c=="{"&&(o.match(/^( )*(d|D|t|T|ts|TS)( )*'[^']*'( )*}/)||o.match(/^( )*(d|D|t|T|ts|TS)( )*"[^"]*"( )*}/)))return"number";o.eatWhile(/^[_\w\d]/);var u=o.current().toLowerCase();return k.hasOwnProperty(u)&&(o.match(/^( )+'[^']*'/)||o.match(/^( )+"[^"]*"/))?"number":h.hasOwnProperty(u)?"atom":P.hasOwnProperty(u)?"builtin":U.hasOwnProperty(u)?"keyword":S.hasOwnProperty(u)?"string-2":null}}function re(o,x){return function(c,d){for(var u=!1,y;(y=c.next())!=null;){if(y==o&&!u){d.tokenize=G;break}u=(D||x)&&!u&&y=="\\"}return"string"}}function K(o){return function(x,c){var d=x.match(/^.*?(\/\*|\*\/)/);return d?d[1]=="/*"?c.tokenize=K(o+1):o>1?c.tokenize=K(o-1):c.tokenize=G:x.skipToEnd(),"comment"}}function ne(o,x,c){x.context={prev:x.context,indent:o.indentation(),col:o.column(),type:c}}function $(o){o.indent=o.context.indent,o.context=o.context.prev}return{startState:function(){return{tokenize:G,context:null}},token:function(x,c){if(x.sol()&&c.context&&c.context.align==null&&(c.context.align=!1),c.tokenize==G&&x.eatSpace())return null;var d=c.tokenize(x,c);if(d=="comment")return d;c.context&&c.context.align==null&&(c.context.align=!0);var u=x.current();return u=="("?ne(x,c,")"):u=="["?ne(x,c,"]"):c.context&&c.context.type==u&&$(c),d},indent:function(x,c){var d=x.context;if(!d)return i.Pass;var u=c.charAt(0)==d.type;return d.align?d.col+(u?0:1):d.indent+(u?0:m.indentUnit)},blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:a.commentSlashSlash?"//":a.commentHash?"#":"--",closeBrackets:"()[]{}''\"\"``"}});function e(m){for(var T;(T=m.next())!=null;)if(T=="`"&&!m.eat("`"))return"variable-2";return m.backUp(m.current().length-1),m.eatWhile(/\w/)?"variable-2":null}function r(m){for(var T;(T=m.next())!=null;)if(T=='"'&&!m.eat('"'))return"variable-2";return m.backUp(m.current().length-1),m.eatWhile(/\w/)?"variable-2":null}function s(m){return m.eat("@")&&(m.match("session."),m.match("local."),m.match("global.")),m.eat("'")?(m.match(/^.*'/),"variable-2"):m.eat('"')?(m.match(/^.*"/),"variable-2"):m.eat("`")?(m.match(/^.*`/),"variable-2"):m.match(/^[0-9a-zA-Z$\.\_]+/)?"variable-2":null}function g(m){return m.eat("N")?"atom":m.match(/^[a-zA-Z.#!?]/)?"variable-2":null}var n="alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit ";function F(m){for(var T={},S=m.split(" "),h=0;h<S.length;++h)T[S[h]]=!0;return T}var R="bool boolean bit blob enum long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision real date datetime year unsigned signed decimal numeric";i.defineMIME("text/iotdb-sql",{name:"sql",keywords:F("non_negative_derivative derivative non_negative_difference difference time_difference bottom_k top_k string_matches string_contains abs sqrt log10 ln exp round floor ceil sign radians degrees atan acos asin tan cos sin int32 int64 float double boolean text false true null time timestamp lock any without debug explain tolerance like concat contain top asc desc stop start after before triggers trigger as functions function temporary schema for snapshot partition latest cache clear full global rename tags attributes compression align disable last last_value sum first_value avg max_value min_value max_time min_time level nodes count devices paths child move remove version info task flush ttl unset watermark_embedding load revoke password alter of all role privileges user list merge drop off on tracing using index link now values alias upsert add bitmap encoding insert create update delete select show query kill processlist grant into set where from to order by device configuration describe slimit limit unlink offset soffset fill linear previous previousuntillast metadata timeseries property with datatype compressor storage group label"),builtin:F("root now non_negative_derivative derivative non_negative_difference difference time_difference bottom_k top_k string_matches string_contains max_time min_time max_value min_value last_value first_value sum avg count abs sqrt log10 ln exp round floor ceil sign radians degrees atan acos asin tan cos sin false true null time timestamp int32 int64 float double boolean text"),atoms:F("plain plain_dictionary rle diff ts_2diff gorilla regular pla paa lzo gzip lz4 snappy uncompressed"),dateSQL:F(""),support:F("commentHash ODBCdotTable doubleQuote binaryNumber hexNumber")})});var Cn=l(71707),Mn=l(3585),kn=l(14504),wn=ge.Z.Search,Rn=ge.Z.TextArea,Br=function(e){var r=(0,ae.YB)(),s=e.done,g=e.visible,n=e.setVisible,F=e.exportCsv,R=e.activeQueryTabkey,m=(0,ae.tT)("@@initialState"),T=m.initialState,S=m.setInitialState,h=v.useState(void 0),P=(0,Z.Z)(h,2),U=P[0],B=P[1],a=(0,v.useState)({query1:"select * from root"}),q=(0,Z.Z)(a,1),k=q[0],D=v.useState("number"),H=(0,Z.Z)(D,2),z=H[0],G=H[1],re=v.useState("+08:00"),K=(0,Z.Z)(re,2),ne=K[0],$=K[1],o=v.useState(!0),x=(0,Z.Z)(o,2),c=x[0],d=x[1],u=v.useState("plain"),y=(0,Z.Z)(u,2),b=y[0],A=y[1],O=Te.Z.useForm(),N=(0,Z.Z)(O,1),Q=N[0],I=(0,t.jsx)($t.Rt,{value:k.query1,options:{mode:"text/iotdb-sql",theme:"juejin",autofocus:!1,lineNumbers:!0,tabindex:1,extraKeys:{"Alt-/":"autocomplete","Ctrl-/":"toggleComment"},matchBrackets:!0,indentWithTabs:!0,smartIndent:!0,hintOptions:{completeSingle:!1}},onChange:function(W,ie,fe){ie.origin!=null&&(ie.removed[0].trim()!=""||ie.text[0].match(/^[a-zA-Z0-9_]+$/))&&W.showHint(),k.query1=fe}});return g?(0,t.jsxs)(Ge.Z,{visible:g,form:Q,title:r.formatMessage({id:"query.sql.export"}),className:je().standardListForm,column:2,submitter:{submitButtonProps:{style:{display:"none"}},render:function(W,ie){return[].concat((0,we.Z)(ie),[(0,t.jsx)(ve.Z,{type:"primary",onClick:function(){F({queryCommand:k.query1,targetFile:U,timeformat:z,timeZone:ne,compress:b})},children:r.formatMessage({id:"query.sql.export"})},"export")])}},modalProps:{onCancel:function(){return n(!1)},destroyOnClose:!0,bodyStyle:s?{padding:"72px 0"}:{}},children:[(0,t.jsx)("div",{style:{marginBottom:10},children:r.formatMessage({id:"query.sql.export.sqlWithRequired"})}),(0,t.jsx)("div",{style:{marginBottom:20},children:I}),(0,t.jsxs)(yt.Z,{gutter:16,children:[(0,t.jsx)(Re.Z,{lg:12,md:24,sm:48,children:(0,t.jsx)(At.Z,{name:"name",label:r.formatMessage({id:"query.sql.export.backupNameWithOptional"}),placeholder:"dump",fieldProps:{value:U,onChange:function(W){B(W.target.value)}}})}),(0,t.jsx)(Re.Z,{lg:10,md:20,sm:40,children:(0,t.jsx)(gt.Z.Group,{name:"compress",label:r.formatMessage({id:"query.sql.export.compressionMode"}),radioType:"button",size:"small",options:[{label:r.formatMessage({id:"query.sql.export.compression.no"}),value:"plain"},{label:"GZIP",value:"gzip"},{label:"SNAPPY",value:"snappy"}],initialValue:b,fieldProps:{buttonStyle:"solid",onChange:function(W){A(W.target.value)}}})})]}),(0,t.jsxs)(yt.Z,{gutter:16,children:[(0,t.jsx)(Re.Z,{lg:12,md:24,sm:48,children:(0,t.jsx)(gt.Z.Group,{name:"tf",label:r.formatMessage({id:"query.sql.export.timeFormat"}),radioType:"button",size:"small",options:[{label:r.formatMessage({id:"query.sql.export.timeFormat.number"}),value:"number"},{label:r.formatMessage({id:"query.sql.export.timeFormat.default"}),value:"default"},{label:r.formatMessage({id:"query.sql.export.timeFormat.timestamp"}),value:"yyyy-MM-dd HH:mm:ss.SSS"}],initialValue:z,fieldProps:{buttonStyle:"solid",onChange:function(W){W.target.value=="number"?d(!0):d(!1),G(W.target.value)}}})}),(0,t.jsx)(Re.Z,{lg:10,md:20,sm:40,children:(0,t.jsx)(It.Z,{label:r.formatMessage({id:"query.sql.export.timeZone"}),name:"zone",disabled:c,options:[{label:"-12:00",value:"-12:00"},{label:"-11:00",value:"-11:00"},{label:"-10:00",value:"-10:00"},{label:"-09:00",value:"-09:00"},{label:"-08:00",value:"-08:00"},{label:"-07:00",value:"-07:00"},{label:"-06:00",value:"-06:00"},{label:"-05:00",value:"-05:00"},{label:"-04:00",value:"-04:00"},{label:"-03:00",value:"-03:00"},{label:"-02:00",value:"-02:00"},{label:"-01:00",value:"-01:00"},{label:"+00:00",value:"+00:00"},{label:"+01:00",value:"+01:00"},{label:"+02:00",value:"+02:00"},{label:"+03:00",value:"+03:00"},{label:"+04:00",value:"+04:00"},{label:"+05:00",value:"+05:00"},{label:"+06:00",value:"+06:00"},{label:"+07:00",value:"+07:00"},{label:"+08:00",value:"+08:00"},{label:"+09:00",value:"+09:00"},{label:"+10:00",value:"+10:00"},{label:"+11:00",value:"+11:00"},{label:"+12:00",value:"+12:00"}],initialValue:"+08:00",fieldProps:{allowClear:!1,onChange:function(W){$(W)}}})})]})]}):null},Yr=Br,En=l(43185),Kr=l(11324),Fn=ge.Z.Search,Pn=ge.Z.TextArea,Jr=function(e){var r=(0,ae.YB)(),s=e.done,g=e.visible,n=e.setVisible,F=e.activeQueryTabkey,R=v.useState(void 0),m=(0,Z.Z)(R,2),T=m[0],S=m[1],h=v.useState("+08:00"),P=(0,Z.Z)(h,2),U=P[0],B=P[1],a=v.useState("plain"),q=(0,Z.Z)(a,2),k=q[0],D=q[1],H=v.useState(0),z=(0,Z.Z)(H,2),G=z[0],re=z[1],K=v.useState(!1),ne=(0,Z.Z)(K,2),$=ne[0],o=ne[1],x=Te.Z.useForm(),c=(0,Z.Z)(x,1),d=c[0];return g?(0,t.jsx)(Ge.Z,{visible:g,form:d,title:r.formatMessage({id:"query.sql.import"}),className:je().standardListForm,column:2,submitter:{submitButtonProps:{style:{display:"none"}},render:function(y,b){return[].concat((0,we.Z)(b),[(0,t.jsx)(Kr.Z,{action:"/api/query/importCsv",name:"Filedata",showUploadList:!1,data:{compress:k,timeZone:U},beforeUpload:function(O){var N=O.name,Q=N.substring(N.lastIndexOf(".")),I=O.size,X=3,W=Math.ceil(I/1024/1024),ie=Math.ceil(W*10);return k=="plain"&&Q!=".csv"?(le.default.error({message:r.formatMessage({id:"query.sql.import.compression.no.rule"})}),!1):k=="snappy"&&Q!=".snappy"?(le.default.error({message:r.formatMessage({id:"query.sql.import.compression.snappy.rule"})}),!1):k=="gzip"&&Q!=".gz"?(le.default.error({message:r.formatMessage({id:"query.sql.import.compression.gzip.rule"})}),!1):W>X?(le.default.error({message:r.formatMessage({id:"query.sql.import.size.rule"})+" "+X+" MB"}),!1):!0},onChange:function(O){O.file.response!=null&&(o(!1),(O.file.response.code!="0"||O.file.status=="error")&&le.default.error({message:O.file.response.message}))},withCredentials:!0,children:(0,t.jsx)(ve.Z,{type:"primary",children:r.formatMessage({id:"query.sql.import.selectFile"})},"import")},"upload")])}},modalProps:{onCancel:function(){n(!1)},destroyOnClose:!0,bodyStyle:s?{padding:"72px 0"}:{}},children:(0,t.jsxs)(yt.Z,{gutter:16,children:[(0,t.jsx)(Re.Z,{lg:12,md:24,sm:48,children:(0,t.jsx)(gt.Z.Group,{name:"compress",label:r.formatMessage({id:"query.sql.export.compressionMode"}),radioType:"button",size:"small",options:[{label:r.formatMessage({id:"query.sql.export.compression.no"}),value:"plain"},{label:"GZIP",value:"gzip"},{label:"SNAPPY",value:"snappy"}],initialValue:k,fieldProps:{buttonStyle:"solid",onChange:function(y){D(y.target.value)}}})}),(0,t.jsx)(Re.Z,{lg:10,md:20,sm:40,children:(0,t.jsx)(It.Z,{label:r.formatMessage({id:"query.sql.export.timeZone"}),tooltip:r.formatMessage({id:"query.sql.export.timeZone.description"}),name:"zone",options:[{label:"-12:00",value:"-12:00"},{label:"-11:00",value:"-11:00"},{label:"-10:00",value:"-10:00"},{label:"-09:00",value:"-09:00"},{label:"-08:00",value:"-08:00"},{label:"-07:00",value:"-07:00"},{label:"-06:00",value:"-06:00"},{label:"-05:00",value:"-05:00"},{label:"-04:00",value:"-04:00"},{label:"-03:00",value:"-03:00"},{label:"-02:00",value:"-02:00"},{label:"-01:00",value:"-01:00"},{label:"+00:00",value:"+00:00"},{label:"+01:00",value:"+01:00"},{label:"+02:00",value:"+02:00"},{label:"+03:00",value:"+03:00"},{label:"+04:00",value:"+04:00"},{label:"+05:00",value:"+05:00"},{label:"+06:00",value:"+06:00"},{label:"+07:00",value:"+07:00"},{label:"+08:00",value:"+08:00"},{label:"+09:00",value:"+09:00"},{label:"+10:00",value:"+10:00"},{label:"+11:00",value:"+11:00"},{label:"+12:00",value:"+12:00"}],initialValue:"+08:00",fieldProps:{value:U,allowClear:!1,onChange:function(y){B(y)}}})})]})}):null},Xr=Jr,_r=l(44008),xt=l(55877),On=l(402),Nt=l(59289),Hn=l(77883),bt=l(51368),Ve=l(93224),ea=l(54549),ta=l(79508),ra=l(2603),aa=l(81296),na=l(58848),be;(function(i){i.INITHEIGHT="INITHEIGHT",i.RENDERTR="RENDERTR",i.RESET="RESET"})(be||(be={}));var Qt={rowHeight:0,curScrollTop:0,scrollHeight:0,tableScrollY:0};function la(i,e){var r=e.curScrollTop,s=e.scrollHeight,g=e.tableScrollY,n=e.rowHeight;switch(e.type){case be.RENDERTR:return s<0&&(s=0),i.scrollHeight&&g===i.tableScrollY&&(s=i.scrollHeight),i.scrollHeight&&r>i.scrollHeight&&(r=i.scrollHeight),(0,f.Z)((0,f.Z)({},i),{},{curScrollTop:r,scrollHeight:s,tableScrollY:g});case be.INITHEIGHT:return(0,f.Z)((0,f.Z)({},i),{},{rowHeight:n});case be.RESET:return(0,f.Z)((0,f.Z)({},i),{},{curScrollTop:0,scrollHeight:0});default:throw new Error}}var St=(0,v.createContext)({dispatch:Function,renderLen:1,start:0,offsetStart:0,rowHeight:Qt.rowHeight,totalLen:0}),Zt=0,Ie=null,An=function(e){var r=e.children,s=_objectWithoutProperties(e,["children"]);return _jsx("td",_objectSpread(_objectSpread({},s),{},{children:_jsx("div",{children:"zxc"})}))},ia=function(e){var r=(0,v.useContext)(St),s=r.dispatch,g=r.rowHeight,n=r.totalLen,F=e.children,R=(0,Ve.Z)(e,["children"]),m=(0,v.useRef)(null);return(0,v.useEffect)(function(){var T=function(h){var P;if(h!=null&&(P=h.current)!==null&&P!==void 0&&P.offsetHeight&&!g&&n){var U,B,a=(U=h==null||(B=h.current)===null||B===void 0?void 0:B.offsetHeight)!==null&&U!==void 0?U:0;s({type:be.INITHEIGHT,rowHeight:a})}};T(m)},[m,g,n,s]),(0,t.jsx)("tr",(0,f.Z)((0,f.Z)({},R),{},{ref:m,style:{height:g||"auto",boxSizing:"border-box"},children:F}))},sa=function(e){var r=e.children,s=(0,Ve.Z)(e,["children"]),g=(0,v.useContext)(St),n=g.renderLen,F=g.start,R=g.offsetStart,m=r[1],T=null;return Array.isArray(m)&&m.length?T=[r[0],m.slice(F,F+n).map(function(S){return Array.isArray(S)?S[0]:S})]:T=r,(0,t.jsx)("tbody",(0,f.Z)((0,f.Z)({},s),{},{style:{transform:"translateY(-".concat(R,"px)")},children:T}))},Ee=null,ua=function(e){var r,s,g,n,F=e.style,R=e.children,m=(0,Ve.Z)(e,["style","children"]),T=(0,v.useReducer)(la,Qt),S=(0,Z.Z)(T,2),h=S[0],P=S[1],U=(0,v.useRef)(null),B=(0,v.useState)((r=(s=R[1])===null||s===void 0||(g=s.props)===null||g===void 0||(n=g.data)===null||n===void 0?void 0:n.length)!==null&&r!==void 0?r:0),a=(0,Z.Z)(B,2),q=a[0],k=a[1];(0,v.useEffect)(function(){var $,o,x;if(($=R[1])!==null&&$!==void 0&&(o=$.props)!==null&&o!==void 0&&(x=o.data)!==null&&x!==void 0&&x.length){var c,d,u;k((c=R[1])===null||c===void 0||(d=c.props)===null||d===void 0||(u=d.data)===null||u===void 0?void 0:u.length)}},[R]);var D=(0,v.useMemo)(function(){var $="auto";return h.rowHeight&&q&&($=h.rowHeight*q+10),$},[h.rowHeight,q]),H=0;if(typeof Zt=="string"){var z,G;H=(z=Ee.current)===null||z===void 0||(G=z.parentNode)===null||G===void 0?void 0:G.offsetHeight}else H=Zt;(0,aa.Z)(D)&&D<H&&(H=D),H<=0&&(H=0);var re=(0,v.useMemo)(function(){var $=1;if(h.rowHeight&&q&&H)if(H<=0)$=0;else{var o=(H/h.rowHeight|0)+1+2;$=o>q?q:o}return $},[h.rowHeight,q,H]),K=h.rowHeight?h.curScrollTop/h.rowHeight|0:0,ne=h.rowHeight?h.curScrollTop%h.rowHeight:0;return h.curScrollTop&&h.rowHeight&&h.curScrollTop>h.rowHeight?K>q-re?ne=0:K>1&&(K=K-1,ne+=h.rowHeight):K=0,(0,v.useEffect)(function(){var $,o,x=($=Ee)===null||$===void 0||(o=$.current)===null||o===void 0?void 0:o.parentNode;x&&(x.scrollTop=0),P({type:be.RESET})},[q]),(0,v.useEffect)(function(){var $,o,x=(0,na.Z)(function(d){var u,y,b,A,O,N,Q=(u=d==null||(y=d.target)===null||y===void 0?void 0:y.scrollTop)!==null&&u!==void 0?u:0,I=(b=d==null||(A=d.target)===null||A===void 0?void 0:A.scrollHeight)!==null&&b!==void 0?b:0,X=(O=d==null||(N=d.target)===null||N===void 0?void 0:N.clientHeight)!==null&&O!==void 0?O:0;if(Q===I?Ie&&Ie():Q+X===I&&Ie&&Ie(),Q!==h.curScrollTop){var W=d.target.scrollHeight-H;P({type:be.RENDERTR,curScrollTop:Q,scrollHeight:W,tableScrollY:H})}},60),c=($=Ee)===null||$===void 0||(o=$.current)===null||o===void 0?void 0:o.parentNode;return c&&c.addEventListener("scroll",x),function(){c==null||c.removeEventListener("scroll",x)}},[Ee,h.curScrollTop,H,h.scrollHeight]),(0,t.jsx)("div",{ref:Ee,style:{width:"100%",position:"relative",height:D,boxSizing:"border-box",paddingTop:h.curScrollTop},children:(0,t.jsx)(St.Provider,{value:{dispatch:P,start:K,offsetStart:ne,renderLen:re,totalLen:q,rowHeight:h.rowHeight},children:(0,t.jsx)("table",(0,f.Z)((0,f.Z)({},m),{},{ref:U,style:(0,f.Z)({width:"100%",position:"relative"},F),children:R}))})})},oa=function(e){var r=e.columns,s=e.scroll,g=e.sticky,n=e.pagination,F=e.editingKey,R=e.setEditingKey,m=e.form,T=e.updatePoint,S=e.data,h=e.setData,P=e.active,U=e.rowKey,B=e.clearEditable,a=e.wrapTableRef,q=e.timeDisplayForm,k=function(u){return u[U]===F},D=(0,v.useState)({}),H=(0,Z.Z)(D,2),z=H[0],G=H[1],re=v.useRef(null),K={ref:re},ne=function(u){var y=u.editing,b=u.dataIndex,A=u.title,O=u.inputType,N=u.record,Q=u.index,I=u.children,X=(0,Ve.Z)(u,["editing","dataIndex","title","inputType","record","index","children"]),W=O==="number"?(0,t.jsx)(bt.Z,{}):(0,t.jsx)(ge.Z,{readOnly:z[b]!=!0,addonAfter:b!=null&&b.indexOf(".")<0?null:z[b]==!0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("a",{title:"unsave",children:(0,t.jsx)(ea.Z,{style:{color:"#fc4c2f"},onClick:function(){var ie=(0,J.Z)(j().mark(function fe(Tt){var se;return j().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:se={},se[b]=N[b],m.setFieldsValue((0,f.Z)({},se)),z[b]=!1,G((0,f.Z)({},z));case 5:case"end":return ce.stop()}},fe)}));return function(fe){return ie.apply(this,arguments)}}()})}),(0,t.jsx)(ee.Z,{type:"vertical"}),(0,t.jsx)("a",{title:"save",onClick:function(){var ie=(0,J.Z)(j().mark(function fe(Tt){var se,oe,ce,qe,$e,Ce;return j().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return de.next=2,T(N.Time,b,m.getFieldsValue()[b]);case 2:if(se=de.sent,z[b]=!1,G((0,f.Z)({},z)),!(se!=null&&se.message!=null)){de.next=22;break}if(se.code!="0"){de.next=18;break}return de.next=9,m.validateFields();case 9:oe=de.sent,oe[b]=se.data,m.setFieldsValue((0,f.Z)({},oe)),ce=(0,we.Z)(S[P]),S[P]=ce,qe=ce.findIndex(function(Ue){return N[U]===Ue[U]}),qe>-1&&($e=ce[qe],$e[b]=oe[b],S[P]=ce,h((0,f.Z)({},S))),de.next=22;break;case 18:le.default.error({message:se.message}),Ce={},Ce[b]=N[b],m.setFieldsValue((0,f.Z)({},Ce));case 22:case"end":return de.stop()}},fe)}));return function(fe){return ie.apply(this,arguments)}}(),children:(0,t.jsx)(ta.Z,{style:{color:"#1890ff"}})})]}):(0,t.jsx)("a",{title:"click to unlock",onClick:function(){z[b]=!0,G((0,f.Z)({},z))},children:(0,t.jsx)(ra.Z,{})})});return(0,t.jsx)("td",(0,f.Z)((0,f.Z)({},X),{},{children:y?(0,t.jsx)(Te.Z.Item,{name:b,style:{margin:0},rules:[],children:W}):I}))};r.length>1&&(r[0].render=function(d,u){return(0,t.jsxs)("span",{children:[S[P][u.index-1][r[0].key],(0,t.jsx)("div",{children:"\xA0"})]})},r[1].render=function(d,u){if(r[1].key=="Time"){var y=k(u);return y?(0,t.jsxs)("span",{children:[S[P][u.index-1].Time,(0,t.jsx)("div",{children:(0,t.jsx)(Nt.Z.Link,{onClick:o,children:"finish"})})]}):(0,t.jsxs)("span",{children:[q[P]=="utc"?Ht()(parseInt(S[P][u.index-1].Time)).utc().format("YYYY-MM-DD HH:mm:ss.SSS"):S[P][u.index-1].Time,(0,t.jsx)("div",{children:(0,t.jsx)(Nt.Z.Link,{onClick:function(){return $(u)},children:"edit"})})]})}else return S[P][u.index-1][r[1].key]});var $=function(){var d=(0,J.Z)(j().mark(function u(y){var b,A;return j().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return G({}),N.next=3,m.validateFields();case 3:b=N.sent,A={},Object.keys(y).map(function(Q,I){Q!=U&&(A[Q]=y[Q])}),Object.keys(r).map(function(Q,I){y[Q]==null&&(A[Q]=null)}),m.setFieldsValue((0,f.Z)({},A)),R(y[U]);case 9:case"end":return N.stop()}},u)}));return function(y){return d.apply(this,arguments)}}(),o=function(){B()},x=function(){var d=(0,J.Z)(j().mark(function u(y){var b,A,O,N;return j().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.prev=0,I.next=3,m.validateFields();case 3:b=I.sent,A=(0,we.Z)(S[P]),O=A.findIndex(function(X){return y[U]===X[U]}),O>-1?(N=A[O],A.splice(O,1,(0,f.Z)((0,f.Z)({},N),b)),S[P]=A,h((0,f.Z)({},S))):(A.push(b),S[P]=A,h((0,f.Z)({},S))),I.next=12;break;case 9:I.prev=9,I.t0=I.catch(0),console.log("Validate Failed:",I.t0);case 12:B();case 13:case"end":return I.stop()}},u,null,[[0,9]])}));return function(y){return d.apply(this,arguments)}}(),c=r.map(function(d){return d.editable?(0,f.Z)((0,f.Z)({},d),{},{onCell:function(y){return{record:y,inputType:"text",dataIndex:d.dataIndex,title:d.title,editing:k(y)}}}):d});return(0,t.jsx)(Te.Z,{form:m,component:!1,children:(0,t.jsx)(Xe.Z,{components:Lt({height:450,cell:ne,wrapTableRef:a}),bordered:!0,rowKey:U,dataSource:S[P],columns:c,rowClassName:"editable-row",scroll:s,sticky:g,pagination:n})})},Lt=function(e){return Zt=e.height,Ie=e.onReachEnd,Ee=e.wrapTableRef,{table:ua,body:{wrapper:sa,row:ia,cell:e.cell}}},ca=function(e){return oa(e)},da=l(69610),fa=l(54941),ma=l(81306),va=l(59206),pa=function(i){(0,ma.Z)(r,i);var e=(0,va.Z)(r);function r(){return(0,da.Z)(this,r),e.apply(this,arguments)}return(0,fa.Z)(r,[{key:"render",value:function(){return this.props.addonAfter?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(bt.Z,(0,f.Z)({style:{borderBottomRightRadius:0,borderTopRightRadius:0}},this.props)),(0,t.jsx)("div",{className:"ant-input-group-addon",style:{marginTop:"-4px",paddingTop:"2px",display:"inline-table",lineHeight:"24px",height:"32px"},children:this.props.addonAfter})]}):(0,t.jsx)(bt.Z,(0,f.Z)({},this.props))}}]),r}(v.Component),ha=l(53667),ya=l.n(ha),zt=et.Z.Option,ga=function(){var e=(0,ae.YB)(),r=(0,ae.tT)("@@initialState"),s=r.initialState,g=r.setInitialState,n=(0,v.useState)({query1:"SHOW STORAGE GROUP"}),F=(0,Z.Z)(n,2),R=F[0],m=F[1],T=(0,v.useState)({query1:"SHOW STORAGE GROUP"}),S=(0,Z.Z)(T,2),h=S[0],P=S[1],U=(0,v.useState)("query1"),B=(0,Z.Z)(U,2),a=B[0],q=B[1],k=(0,v.useRef)("query1");(0,v.useEffect)(function(){k.current=a},[a]);var D=(0,v.useState)(!1),H=(0,Z.Z)(D,2),z=H[0],G=H[1],re=(0,v.useState)(!1),K=(0,Z.Z)(re,2),ne=K[0],$=K[1],o=(0,v.useState)(void 0),x=(0,Z.Z)(o,2),c=x[0],d=x[1],u=(0,v.useState)(!1),y=(0,Z.Z)(u,2),b=y[0],A=y[1],O=(0,v.useState)(!1),N=(0,Z.Z)(O,2),Q=N[0],I=N[1],X=(0,v.useState)(!1),W=(0,Z.Z)(X,2),ie=W[0],fe=W[1],Tt=(0,v.useState)({}),se=(0,Z.Z)(Tt,2),oe=se[0],ce=se[1],qe=(0,v.useRef)([]);(0,v.useEffect)(function(){qe.current=oe},[oe]);var $e=(0,v.useRef)(null),Ce=null,Gt=(0,t.jsx)($t.Rt,{value:R[a],options:(0,gr.Z)({mode:"text/iotdb-sql",theme:"juejin",autofocus:!0,lineNumbers:!0,tabindex:1,extraKeys:{"Alt-/":"autocomplete","Cmd-/":"toggleComment","Ctrl-/":"toggleComment","Shift-Cmd-F":function(){dr()},"Shift-Ctrl-F":function(){dr()},F8:function(){Ct()}},matchBrackets:!0,readOnly:z,indentWithTabs:!0,smartIndent:!0,hintOptions:{completeSingle:!1}},"autofocus",!1),onChange:function(p,w,C){w.origin!=null&&(w.removed[0].trim()!=""||w.text[0].match(/^[a-zA-Z0-9_]+$/))&&p.showHint(),R[a]=C,h[a]=C},onCursorActivity:function(p){p.getSelection()!=null&&p.getSelection()!=""&&(h[k.current]=p.getSelection())}}),de=(0,v.useState)({tabActiveKey:"tab1",operationKey:"query1"}),Ue=(0,Z.Z)(de,2),ba=Ue[0],Sa=Ue[1],Za=(0,v.useState)({}),Vt=(0,Z.Z)(Za,2),pe=Vt[0],Ne=Vt[1],Me=(0,v.useRef)([]);(0,v.useEffect)(function(){Me.current=pe},[pe]);var Ta=(0,v.useState)([]),Ut=(0,Z.Z)(Ta,2),me=Ut[0],De=Ut[1],Se=(0,v.useRef)([]);(0,v.useEffect)(function(){Se.current=me},[me]);var ja=(0,v.useState)([]),Dt=(0,Z.Z)(ja,2),xe=Dt[0],Qe=Dt[1],he=(0,v.useRef)([]);(0,v.useEffect)(function(){he.current=xe},[xe]);var qa=(0,v.useState)([]),Wt=(0,Z.Z)(qa,2),ye=Wt[0],Bt=Wt[1],Ca=(0,v.useState)([]),Yt=(0,Z.Z)(Ca,2),Ze=Yt[0],Ma=Yt[1],ka=(0,v.useState)([]),Kt=(0,Z.Z)(ka,2),jt=Kt[0],wa=Kt[1],Ra=(0,v.useState)([]),Jt=(0,Z.Z)(Ra,2),Le=Jt[0],Ea=Jt[1],Fa=(0,v.useState)([{}]),Xt=(0,Z.Z)(Fa,2),In=Xt[0],$n=Xt[1],Pa=(0,v.useState)(""),_t=(0,Z.Z)(Pa,2),Oa=_t[0],er=_t[1],Ha=(0,v.useState)({}),tr=(0,Z.Z)(Ha,2),Fe=tr[0],rr=tr[1],Aa=(0,v.useState)([]),ar=(0,Z.Z)(Aa,2),We=ar[0],Ia=ar[1],$a=Te.Z.useForm(),Na=(0,Z.Z)($a,1),qt=Na[0],Pe=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ee.Z,{type:"vertical"}),(0,t.jsxs)("span",{children:[e.formatMessage({id:"query.result.locate.text"})," "]}),(0,t.jsx)(pa,{style:{width:170,size:"small"},placeholder:"index or Time..",min:0,max:9223372036854776e3,onChange:function(p){We[a]=p,Ia((0,f.Z)({},We))},onPressEnter:function(){nr()},addonAfter:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("a",{onClick:function(){nr()},children:"index "}),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.locate.or"}),(0,t.jsx)(ee.Z,{type:"vertical"}),(0,t.jsx)("a",{onClick:function(){za()},children:"Time "})]})}),(0,t.jsx)(ee.Z,{type:"vertical"}),(0,t.jsxs)(et.Z,{placeholder:e.formatMessage({id:"query.result.time.displayAs"}),style:{width:140},onChange:function(p){La(p)},children:[(0,t.jsx)(zt,{value:"number",children:"Number"}),(0,t.jsx)(zt,{value:"utc",children:"UTC"})]}),(0,t.jsx)(ee.Z,{type:"vertical"}),(0,t.jsx)("a",{onClick:function(){var p=Se.current[a].map(function(w,C){return w.title}).filter(function(w){return w!="index"});Qa(a,p,he.current[a])},children:e.formatMessage({id:"query.result.download"})})]}),Qa=function(p,w,C){var M={};M.fileName=p;var V=w.map(function(L,vr){return 10});M.datas=[{sheetData:C,sheetName:p,sheetFilter:w,sheetHeader:w,columnWidths:V}];var te=new(ya())(M);te.saveExcel()},La=function(p){jt[a]=p,wa((0,f.Z)({},jt))},nr=function(){Fe[a]=We[a],rr((0,f.Z)({},Fe)),lr()},za=function(){if(Se.current[a][1].title=="Time"){var p=he.current[a].find(function(w){return w.Time>=We[a]});p=p==null?he.current[a][he.current[a].length-1]:p,Fe[a]=p.index,rr((0,f.Z)({},Fe)),lr()}},lr=function(){var p=Fe[a]==null?0:Fe[a];p=p<1?1:p;var w=77*(p-1);$e.current.parentNode.scrollTop=w},ir=function(){var E=(0,J.Z)(j().mark(function p(){var w,C,M,V,te,L;return j().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return Me.current[a]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(a," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(Ze[a]," ms"),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(ye[a]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.load.ing"})]}),Pe]}),w=(0,xt.v4)().replaceAll("-",""),oe[k.current]=w,ce((0,f.Z)({},oe)),Y.next=6,Er({queryToken:Le[a],tabKey:k.current,tabToken:w});case 6:if(C=Y.sent,C.code!="0"){Y.next=25;break}if(me[a]=[],M=JSON.parse(C.message||"{}"),M.tabToken==qe.current[M.tabKey]){Y.next=13;break}return le.default.error({message:e.formatMessage({id:"query.result.expired"})}),Y.abrupt("return");case 13:for(V=C.data==null?[]:C.data,te=he.current[a].length,ye[a]=te+V.length,Bt((0,f.Z)({},ye)),M.hasMore?Me.current[a]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(a," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(Ze[a]," ms"),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(ye[a]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ee.Z,{type:"vertical"})]}),(0,t.jsx)("a",{onClick:function(){ir()},children:e.formatMessage({id:"query.result.load.next"})}),Pe]}):Me.current[a]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(a," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(Ze[a]," ms"),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(ye[a]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.load.done"})]}),Pe]}),Ne((0,f.Z)({},Me.current)),L=0;L<V.length;L++)Object.keys(V[L]).map(function(_,He){if(Se.current[a][_]==null){var ue={title:_,editable:!0,dataIndex:_,width:200,key:_,render:function(Ka){return Ka}};Se.current[a][_]=ue,Se.current[a][Se.current[a].length]=ue}}),V[L].index=te+L+1,he.current[a][te+L]=V[L];he.current[a]=he.current[a].slice(),De((0,f.Z)({},Se.current)),Qe((0,f.Z)({},he.current)),Y.next=26;break;case 25:C.message!=null&&(Me.current[a]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(a," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(Ze[a]," ms"),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(ye[a]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ee.Z,{type:"vertical"}),"".concat(C.message)]}),Pe]}),Ne((0,f.Z)({},Me.current)));case 26:case"end":return Y.stop()}},p)}));return function(){return E.apply(this,arguments)}}(),Ga=function(p,w){p.preventDefault();for(var C=Ye,M=0;M<C.length;M++)if(C[M]!=null&&C[M].key=="query"+w){C[M]=null;break}C=C.filter(function(V){return V!=null}),ur(C),ze(),q("queryPlus"),Je("Plus"),G(!0)},Be=1,Va=(0,v.useState)([{key:"query1",tab:(0,t.jsx)("span",{onClick:function(){q("query1"),Je(1),ze()},children:e.formatMessage({id:"query.query.text"})+"1"})},{key:"queryPlus",tab:(0,t.jsx)(br.Z,{onClick:function(p,w){if(Be==100){alert(e.formatMessage({id:"query.query.rule"}));return}Be+=1;var C=Ye,M=Ye.length;C[M]=C[M-1],C[M-1]={key:"query"+Be,tab:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{onClick:function(){q("query"+M),Je(M),ze()},children:[e.formatMessage({id:"query.query.text"})+Be," "]}),(0,t.jsx)(wt.Z,{title:"Sure to delete?",onConfirm:function(te){Ga(te,M)},children:(0,t.jsx)(Sr.Z,{style:{cursor:"default"},title:"delete"})})]})},C=C.filter(function(V){return V!=null}),ur(C),q("query"+M),Je(M)}})}]),sr=(0,Z.Z)(Va,2),Ye=sr[0],ur=sr[1],or=ve.Z.Group,Ke=function(){return a=="queryPlus"||z?(alert(e.formatMessage({id:"query.query.description"})),!0):!1},ze=function(){var p={};Object.keys(qt.getFieldsValue()).map(function(w,C){p[w]=null}),qt.setFieldsValue((0,f.Z)({},p)),er("")},Ct=function(){var E=(0,J.Z)(j().mark(function p(){var w,C,M,V,te,L;return j().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(ze(),!Ke()){Y.next=3;break}return Y.abrupt("return");case 3:return pe[a]=null,Ne((0,f.Z)({},pe)),me[a]=[],De((0,f.Z)({},me)),xe[a]=[],Qe((0,f.Z)({},xe)),Le[a]==null&&(w=(0,xt.v4)().replaceAll("-",""),Le[a]=w,Ea((0,f.Z)({},Le))),C=h[k.current],h[k.current]=R[k.current],M=(0,xt.v4)().replaceAll("-",""),oe[k.current]=M,ce((0,f.Z)({},oe)),Y.next=18,Rr({sqls:C,queryToken:Le[a],tabKey:k.current,tabToken:M});case 18:if(V=Y.sent,V.code!="0"){Y.next=34;break}if(te=JSON.parse(V.message||"{}"),te.tabToken==qe.current[te.tabKey]){Y.next=24;break}return le.default.error({message:e.formatMessage({id:"query.result.expired"})}),Y.abrupt("return");case 24:L=V.data==null?[]:V.data,Ze[a]=te.costMilliSecond==null?0:te.costMilliSecond,Ma((0,f.Z)({},Ze)),ye[a]=L.length,Bt(ye),te.hasMore?pe[a]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(a," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(Ze[a]," ms"),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(ye[a]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ee.Z,{type:"vertical"})]}),(0,t.jsx)("a",{onClick:function(){ir()},children:e.formatMessage({id:"query.result.load.next"})}),Pe]}):pe[a]=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:["".concat(a," ")+e.formatMessage({id:"query.result.cost.text"})+" ".concat(Ze[a]," ms"),(0,t.jsx)(ee.Z,{type:"vertical"}),e.formatMessage({id:"query.result.return.text"})+" ".concat(ye[a]," ")+e.formatMessage({id:"query.result.return.rows"}),(0,t.jsx)(ee.Z,{type:"vertical"}),"".concat(L.length==0?e.formatMessage({id:"query.result.execute.done"}):e.formatMessage({id:"query.result.load.done"}))]}),(0,t.jsx)("span",{children:Pe})]}),Ne((0,f.Z)({},pe)),L.length==0?(me[a]=[],De((0,f.Z)({},me)),xe[a]=[],Qe((0,f.Z)({},xe))):function(){for(var _=[],He=0;He<L.length;He++)_.index==null&&(_.index={title:"index",editable:!1,dataIndex:"index",width:70,key:"index",fixed:"left"},_[_.length]=_.index),Object.keys(L[He]).map(function(ue,Ya){_[ue]==null&&(_[ue]={title:ue,editable:!(ue=="Time"||ue=="Device"),dataIndex:ue,width:190,key:ue,fixed:ue=="Time"||ue=="Device"?"left":!1},_[_.length]=_[ue])}),L[He].index=He+1;me[a]=_,De((0,f.Z)({},me)),xe[a]=L.slice(),Qe((0,f.Z)({},xe))}(),Y.next=37;break;case 34:pe[a]=a+" "+e.formatMessage({id:"query.result.execute.failed"}),Ne((0,f.Z)({},pe)),le.default.error({message:V.message});case 37:case"end":return Y.stop()}},p)}));return function(){return E.apply(this,arguments)}}(),cr=function(){Ke()||A(!0)},dr=function(){var p=(0,_r.WU)(R[a]);R[a]="",m((0,f.Z)({},R)),R[a]=p,m((0,f.Z)({},R))},Ua=function(){var E=(0,J.Z)(j().mark(function p(w,C,M){var V;return j().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(!Ke()){L.next=2;break}return L.abrupt("return");case 2:return L.next=5,Pr({point:C,value:M,timestamp:w});case 5:return V=L.sent,L.abrupt("return",V);case 7:case"end":return L.stop()}},p)}));return function(w,C,M){return E.apply(this,arguments)}}(),fr=function(){var E=(0,J.Z)(j().mark(function p(){var w;return j().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(!Ke()){M.next=2;break}return M.abrupt("return");case 2:return M.next=5,Pt({pageSize:10,pageNum:1});case 5:w=M.sent,Ae.dealCallback(w,function(V){var te=0;V.data.pageItems.map(function(L){L.key=te++}),d(V.data),$(!0)},le.default);case 7:case"end":return M.stop()}},p)}));return function(){return E.apply(this,arguments)}}(),Da=function(p){if(p.queryCommand==null||p.queryCommand.trim()==""){le.default.error({message:e.formatMessage({id:"query.sql.export.required"})});return}var w="/api/query/exportCsv?sqls="+p.queryCommand+"&timeformat="+p.timeformat+"&timeZone="+p.timeZone+"&compress="+p.compress+"&targetFile="+(p.targetFile==null?"dump":p.targetFile);Ae.download2(w)},Wa=(0,t.jsx)(Cr.Z.Consumer,{children:function(p){var w=p.isMobile;return w?(0,t.jsx)(v.Fragment,{children:(0,t.jsxs)(or,{children:[(0,t.jsxs)(ve.Z,{onClick:cr,children:[(0,t.jsx)(Rt.Z,{}),e.formatMessage({id:"query.sql.script.save"})]}),(0,t.jsxs)(ve.Z,{onClick:fr,children:[(0,t.jsx)(Et.Z,{}),e.formatMessage({id:"query.sql.script.view"})]}),(0,t.jsxs)(ve.Z,{onClick:Ct,type:"primary",children:[(0,t.jsx)(Ft.Z,{}),e.formatMessage({id:"query.sql.execute"})]})]})}):(0,t.jsxs)(v.Fragment,{children:[(0,t.jsx)(yr.Z,{title:(0,t.jsxs)("span",{children:[e.formatMessage({id:"query.sql.tooltip1"}),(0,t.jsx)("br",{}),e.formatMessage({id:"query.sql.tooltip2"}),(0,t.jsx)("br",{}),e.formatMessage({id:"query.sql.tooltip3"}),(0,t.jsx)("br",{}),e.formatMessage({id:"query.sql.tooltip4"}),(0,t.jsx)("br",{}),e.formatMessage({id:"query.sql.tooltip5"})]}),children:(0,t.jsx)(Zr.Z,{})}),(0,t.jsxs)(or,{children:[(0,t.jsxs)(ve.Z,{onClick:Ct,type:"primary",children:[(0,t.jsx)(Ft.Z,{}),e.formatMessage({id:"query.sql.execute"})]}),(0,t.jsxs)(ve.Z,{onClick:cr,children:[(0,t.jsx)(Et.Z,{}),e.formatMessage({id:"query.sql.script.save"})]}),(0,t.jsxs)(hr.Z.Button,{trigger:["hover"],onClick:fr,icon:(0,t.jsx)(Tr.Z,{}),overlay:(0,t.jsxs)(_e.Z,{children:[(0,t.jsxs)(_e.Z.Item,{onClick:function(){I(!0)},children:[(0,t.jsx)(jr.Z,{})," ",e.formatMessage({id:"query.sql.export"})]},"exportCsv"),(0,t.jsxs)(_e.Z.Item,{onClick:function(){fe(!0)},children:[(0,t.jsx)(qr.Z,{})," ",e.formatMessage({id:"query.sql.import"})]},"importCsv")]}),placement:"bottomRight",children:[(0,t.jsx)(Rt.Z,{}),e.formatMessage({id:"query.sql.script.view"})]})]})]})}}),Ba={},mr=Ba.loading;Ce={queryPlus:(0,t.jsx)(Xe.Z,{pagination:!1,loading:mr,dataSource:[],columns:[],scroll:{y:450,scrollToFirstRowOnChange:!1},sticky:!1,components:Lt({height:450})})};for(var Oe=1;Oe<100;Oe++)Ce["query"+Oe]=(0,t.jsx)(ca,{rowKey:"index",loading:mr,columns:me["query"+Oe]==null?[]:me["query"+Oe],scroll:{y:450,scrollToFirstRowOnChange:!1},sticky:!1,pagination:!1,data:xe,setData:Qe,active:"query"+Oe,editingKey:Oa,setEditingKey:er,form:qt,clearEditable:ze,updatePoint:Ua,wrapTableRef:$e,timeDisplayForm:jt});var Je=function(p){G(!1),Sa({tabActiveKey:"tab"+p,operationKey:"query"+p})};return(0,t.jsxs)(Mr.ZP,{title:s.activeConnectionDesc,extra:Wa,className:je().pageHeader,content:Gt,tabList:Ye,tabActiveKey:a,children:[(0,t.jsx)("div",{className:je().main,children:(0,t.jsx)(kr.Z,{children:(0,t.jsx)(pr.Z,{id:"s",className:je().tabsCard,title:pe[a],bordered:!1,children:Ce[ba.operationKey]})})}),(0,t.jsx)(Gr,{visible:ne,setVisible:$,content:c,setContent:d,querySql:R,setQuerySql:m,activeQueryTabkey:a}),(0,t.jsx)(Ur,{visible:b,setVisible:A,querySql:R,activeQueryTabkey:a}),(0,t.jsx)(Yr,{visible:Q,setVisible:I,exportCsv:Da,activeQueryTabkey:a}),(0,t.jsx)(Xr,{destroyOnClose:!0,visible:ie,setVisible:fe,activeQueryTabkey:a})]})},xa=ga}}]);
